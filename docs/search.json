[
  {
    "objectID": "dplyr.html",
    "href": "dplyr.html",
    "title": "3  Dplyr",
    "section": "",
    "text": "4 Adding new Columns"
  },
  {
    "objectID": "dplyr.html#ressources",
    "href": "dplyr.html#ressources",
    "title": "3  Dplyr",
    "section": "3.1 Ressources",
    "text": "3.1 Ressources"
  },
  {
    "objectID": "dplyr.html#what-is-tidy-select",
    "href": "dplyr.html#what-is-tidy-select",
    "title": "3  Dplyr",
    "section": "3.2 What is tidy-select",
    "text": "3.2 What is tidy-select\n\nOfficial docs here\nIn the end you always want a boolean vector that has the length of the number of columns"
  },
  {
    "objectID": "dplyr.html#selecting-columns",
    "href": "dplyr.html#selecting-columns",
    "title": "3  Dplyr",
    "section": "3.3 Selecting columns",
    "text": "3.3 Selecting columns\n\n3.3.1 Selecting columns based on regex\n\nLook here for all the possible helper functions.\nIf you wanna apply a regex yourself you can use the matches-function. However there are “helpers” e.g. starts_with…\n\n\n\nCode\n# select all columns with three characters\nmtcars %&gt;% \n  select(\n    matches(\"^[a-zA-Z]{3}$\")\n  ) %&gt;% head\n\n\n                   mpg cyl\nMazda RX4         21.0   6\nMazda RX4 Wag     21.0   6\nDatsun 710        22.8   4\nHornet 4 Drive    21.4   6\nHornet Sportabout 18.7   8\nValiant           18.1   6\n\n\nCode\n# cant use logical vector is select (e.g select(mtcars, c(TRUE, FALSE))) does not work\n# Must be indexes!\nmtcars %&gt;%\n  select(which(grepl(\"^[a-zA-Z]{3}$\", names(.)))) %&gt;% head\n\n\n                   mpg cyl\nMazda RX4         21.0   6\nMazda RX4 Wag     21.0   6\nDatsun 710        22.8   4\nHornet 4 Drive    21.4   6\nHornet Sportabout 18.7   8\nValiant           18.1   6\n\n\nCode\n# select_if can use a boolean vector!! However is superseeded\nmtcars %&gt;%\n  select_if(grepl(\"^[a-zA-Z]{3}$\", names(.))) %&gt;% head\n\n\n                   mpg cyl\nMazda RX4         21.0   6\nMazda RX4 Wag     21.0   6\nDatsun 710        22.8   4\nHornet 4 Drive    21.4   6\nHornet Sportabout 18.7   8\nValiant           18.1   6\n\n\nCode\n# do the same in base r\nidx = grepl(\"^[a-zA-Z]{3}$\", names(mtcars))\nmtcars[, idx] %&gt;% head\n\n\n                   mpg cyl\nMazda RX4         21.0   6\nMazda RX4 Wag     21.0   6\nDatsun 710        22.8   4\nHornet 4 Drive    21.4   6\nHornet Sportabout 18.7   8\nValiant           18.1   6\n\n\n\n\n3.3.2 Selecting Columns based if any value in the column is na\nApproach 1\n\n# setting the value in the second row and third to nineth column to na\nmtcars_copy = mtcars\nmtcars_copy[2,3:9] = NA\nmtcars_copy %&gt;% head\n\n                   mpg cyl disp  hp drat    wt  qsec vs am gear carb\nMazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4\nMazda RX4 Wag     21.0   6   NA  NA   NA    NA    NA NA NA    4    4\nDatsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1\nHornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1\nHornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2\nValiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1\n\n\n1. where-tidyselect\n\nuse the tidy-select where(fn) function. fn is a function that takes an vector, in this case the entire column, as input. Can be an anonymus function!\n\n\n\nCode\nmtcars_copy %&gt;%\n  select(where(function(x) {\n    sum(is.na(x)) == 0\n  })) %&gt;% head\n\n\n                   mpg cyl gear carb\nMazda RX4         21.0   6    4    4\nMazda RX4 Wag     21.0   6    4    4\nDatsun 710        22.8   4    4    1\nHornet 4 Drive    21.4   6    3    1\nHornet Sportabout 18.7   8    3    2\nValiant           18.1   6    3    1\n\n\n2. `base-r colsums\n\nuse the base-r colSums function which takes only numeric arrays or dataframes as input\nis.na(df) checks for each value in the df if it is NA.\nAnd then it implicitly is numeric as false = 0 and true = 1\n\n\n\nCode\n# 2. base r\nmtcars_copy[, colSums(is.na(mtcars_copy)) == 0]\n\n\n                     mpg cyl gear carb\nMazda RX4           21.0   6    4    4\nMazda RX4 Wag       21.0   6    4    4\nDatsun 710          22.8   4    4    1\nHornet 4 Drive      21.4   6    3    1\nHornet Sportabout   18.7   8    3    2\nValiant             18.1   6    3    1\nDuster 360          14.3   8    3    4\nMerc 240D           24.4   4    4    2\nMerc 230            22.8   4    4    2\nMerc 280            19.2   6    4    4\nMerc 280C           17.8   6    4    4\nMerc 450SE          16.4   8    3    3\nMerc 450SL          17.3   8    3    3\nMerc 450SLC         15.2   8    3    3\nCadillac Fleetwood  10.4   8    3    4\nLincoln Continental 10.4   8    3    4\nChrysler Imperial   14.7   8    3    4\nFiat 128            32.4   4    4    1\nHonda Civic         30.4   4    4    2\nToyota Corolla      33.9   4    4    1\nToyota Corona       21.5   4    3    1\nDodge Challenger    15.5   8    3    2\nAMC Javelin         15.2   8    3    2\nCamaro Z28          13.3   8    3    4\nPontiac Firebird    19.2   8    3    2\nFiat X1-9           27.3   4    4    1\nPorsche 914-2       26.0   4    5    2\nLotus Europa        30.4   4    5    2\nFord Pantera L      15.8   8    5    4\nFerrari Dino        19.7   6    5    6\nMaserati Bora       15.0   8    5    8\nVolvo 142E          21.4   4    4    2\n\n\n3. apply\n\na dataframe is essentially a list of vectors. So we can iterate over it with any mapping-function like apply or map\nFor the MARGIN-argument we set it to 2. So for the columns\n\n\n\nCode\napply(mtcars_copy, 2, function(x)sum(is.na(x)) == 0)\n\n\n  mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb \n TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE \n\n\n\nif we were to set it to one, we would iterate over the rows. All but the second row (Mazda RX4 Wag) will return true\n\n\n\nCode\napply(mtcars_copy, 1, function(x)sum(is.na(x)) == 0)\n\n\n          Mazda RX4       Mazda RX4 Wag          Datsun 710      Hornet 4 Drive \n               TRUE               FALSE                TRUE                TRUE \n  Hornet Sportabout             Valiant          Duster 360           Merc 240D \n               TRUE                TRUE                TRUE                TRUE \n           Merc 230            Merc 280           Merc 280C          Merc 450SE \n               TRUE                TRUE                TRUE                TRUE \n         Merc 450SL         Merc 450SLC  Cadillac Fleetwood Lincoln Continental \n               TRUE                TRUE                TRUE                TRUE \n  Chrysler Imperial            Fiat 128         Honda Civic      Toyota Corolla \n               TRUE                TRUE                TRUE                TRUE \n      Toyota Corona    Dodge Challenger         AMC Javelin          Camaro Z28 \n               TRUE                TRUE                TRUE                TRUE \n   Pontiac Firebird           Fiat X1-9       Porsche 914-2        Lotus Europa \n               TRUE                TRUE                TRUE                TRUE \n     Ford Pantera L        Ferrari Dino       Maserati Bora          Volvo 142E \n               TRUE                TRUE                TRUE                TRUE \n\n\n\nfinally we can use these indeces of the columsn to select them in [,col_indices]\n\n\n\nCode\n# 3. apply\nmtcars_copy[, apply(mtcars_copy, 2, function(x) sum(is.na(x)) == 0)]\n\n\n                     mpg cyl gear carb\nMazda RX4           21.0   6    4    4\nMazda RX4 Wag       21.0   6    4    4\nDatsun 710          22.8   4    4    1\nHornet 4 Drive      21.4   6    3    1\nHornet Sportabout   18.7   8    3    2\nValiant             18.1   6    3    1\nDuster 360          14.3   8    3    4\nMerc 240D           24.4   4    4    2\nMerc 230            22.8   4    4    2\nMerc 280            19.2   6    4    4\nMerc 280C           17.8   6    4    4\nMerc 450SE          16.4   8    3    3\nMerc 450SL          17.3   8    3    3\nMerc 450SLC         15.2   8    3    3\nCadillac Fleetwood  10.4   8    3    4\nLincoln Continental 10.4   8    3    4\nChrysler Imperial   14.7   8    3    4\nFiat 128            32.4   4    4    1\nHonda Civic         30.4   4    4    2\nToyota Corolla      33.9   4    4    1\nToyota Corona       21.5   4    3    1\nDodge Challenger    15.5   8    3    2\nAMC Javelin         15.2   8    3    2\nCamaro Z28          13.3   8    3    4\nPontiac Firebird    19.2   8    3    2\nFiat X1-9           27.3   4    4    1\nPorsche 914-2       26.0   4    5    2\nLotus Europa        30.4   4    5    2\nFord Pantera L      15.8   8    5    4\nFerrari Dino        19.7   6    5    6\nMaserati Bora       15.0   8    5    8\nVolvo 142E          21.4   4    4    2\n\n\n4. using any\n\nSimilar as above. Just not any can be NA\n\n\n\nCode\n# using any\nmtcars_copy[, apply(mtcars_copy, 2, function(x) !any(is.na(x)))]\n\n\n                     mpg cyl gear carb\nMazda RX4           21.0   6    4    4\nMazda RX4 Wag       21.0   6    4    4\nDatsun 710          22.8   4    4    1\nHornet 4 Drive      21.4   6    3    1\nHornet Sportabout   18.7   8    3    2\nValiant             18.1   6    3    1\nDuster 360          14.3   8    3    4\nMerc 240D           24.4   4    4    2\nMerc 230            22.8   4    4    2\nMerc 280            19.2   6    4    4\nMerc 280C           17.8   6    4    4\nMerc 450SE          16.4   8    3    3\nMerc 450SL          17.3   8    3    3\nMerc 450SLC         15.2   8    3    3\nCadillac Fleetwood  10.4   8    3    4\nLincoln Continental 10.4   8    3    4\nChrysler Imperial   14.7   8    3    4\nFiat 128            32.4   4    4    1\nHonda Civic         30.4   4    4    2\nToyota Corolla      33.9   4    4    1\nToyota Corona       21.5   4    3    1\nDodge Challenger    15.5   8    3    2\nAMC Javelin         15.2   8    3    2\nCamaro Z28          13.3   8    3    4\nPontiac Firebird    19.2   8    3    2\nFiat X1-9           27.3   4    4    1\nPorsche 914-2       26.0   4    5    2\nLotus Europa        30.4   4    5    2\nFord Pantera L      15.8   8    5    4\nFerrari Dino        19.7   6    5    6\nMaserati Bora       15.0   8    5    8\nVolvo 142E          21.4   4    4    2\n\n\n\n\n3.3.3 Selecting Columns if the mean is above ten or it is a numeric column\ndplyr select\n\n\nCode\n# add a string column\nmtcars[\"string\"] = \"a\"\n\n# select only string columns or numeric ones with a mean &gt; 10\n\nmtcars %&gt;%\n  dplyr::select(\n    where(\n      function(x) is.character(x) | mean(x) &gt; 10\n    )\n  )\n\n\nWarning in mean.default(x): argument is not numeric or logical: returning NA\n\n\n                     mpg  disp  hp  qsec string\nMazda RX4           21.0 160.0 110 16.46      a\nMazda RX4 Wag       21.0 160.0 110 17.02      a\nDatsun 710          22.8 108.0  93 18.61      a\nHornet 4 Drive      21.4 258.0 110 19.44      a\nHornet Sportabout   18.7 360.0 175 17.02      a\nValiant             18.1 225.0 105 20.22      a\nDuster 360          14.3 360.0 245 15.84      a\nMerc 240D           24.4 146.7  62 20.00      a\nMerc 230            22.8 140.8  95 22.90      a\nMerc 280            19.2 167.6 123 18.30      a\nMerc 280C           17.8 167.6 123 18.90      a\nMerc 450SE          16.4 275.8 180 17.40      a\nMerc 450SL          17.3 275.8 180 17.60      a\nMerc 450SLC         15.2 275.8 180 18.00      a\nCadillac Fleetwood  10.4 472.0 205 17.98      a\nLincoln Continental 10.4 460.0 215 17.82      a\nChrysler Imperial   14.7 440.0 230 17.42      a\nFiat 128            32.4  78.7  66 19.47      a\nHonda Civic         30.4  75.7  52 18.52      a\nToyota Corolla      33.9  71.1  65 19.90      a\nToyota Corona       21.5 120.1  97 20.01      a\nDodge Challenger    15.5 318.0 150 16.87      a\nAMC Javelin         15.2 304.0 150 17.30      a\nCamaro Z28          13.3 350.0 245 15.41      a\nPontiac Firebird    19.2 400.0 175 17.05      a\nFiat X1-9           27.3  79.0  66 18.90      a\nPorsche 914-2       26.0 120.3  91 16.70      a\nLotus Europa        30.4  95.1 113 16.90      a\nFord Pantera L      15.8 351.0 264 14.50      a\nFerrari Dino        19.7 145.0 175 15.50      a\nMaserati Bora       15.0 301.0 335 14.60      a\nVolvo 142E          21.4 121.0 109 18.60      a\n\n\nCode\nmtcars %&gt;%\n  select(\n    where(function(x){\n      if(is.numeric(x)){\n        mean(x) &gt; 10\n      }else{\n        is.character(x) # must return true or false\n      }\n    })\n  )\n\n\n                     mpg  disp  hp  qsec string\nMazda RX4           21.0 160.0 110 16.46      a\nMazda RX4 Wag       21.0 160.0 110 17.02      a\nDatsun 710          22.8 108.0  93 18.61      a\nHornet 4 Drive      21.4 258.0 110 19.44      a\nHornet Sportabout   18.7 360.0 175 17.02      a\nValiant             18.1 225.0 105 20.22      a\nDuster 360          14.3 360.0 245 15.84      a\nMerc 240D           24.4 146.7  62 20.00      a\nMerc 230            22.8 140.8  95 22.90      a\nMerc 280            19.2 167.6 123 18.30      a\nMerc 280C           17.8 167.6 123 18.90      a\nMerc 450SE          16.4 275.8 180 17.40      a\nMerc 450SL          17.3 275.8 180 17.60      a\nMerc 450SLC         15.2 275.8 180 18.00      a\nCadillac Fleetwood  10.4 472.0 205 17.98      a\nLincoln Continental 10.4 460.0 215 17.82      a\nChrysler Imperial   14.7 440.0 230 17.42      a\nFiat 128            32.4  78.7  66 19.47      a\nHonda Civic         30.4  75.7  52 18.52      a\nToyota Corolla      33.9  71.1  65 19.90      a\nToyota Corona       21.5 120.1  97 20.01      a\nDodge Challenger    15.5 318.0 150 16.87      a\nAMC Javelin         15.2 304.0 150 17.30      a\nCamaro Z28          13.3 350.0 245 15.41      a\nPontiac Firebird    19.2 400.0 175 17.05      a\nFiat X1-9           27.3  79.0  66 18.90      a\nPorsche 914-2       26.0 120.3  91 16.70      a\nLotus Europa        30.4  95.1 113 16.90      a\nFord Pantera L      15.8 351.0 264 14.50      a\nFerrari Dino        19.7 145.0 175 15.50      a\nMaserati Bora       15.0 301.0 335 14.60      a\nVolvo 142E          21.4 121.0 109 18.60      a\n\n\napply|map\ntake care !Apply returns weird classes!!\nAlmost all of them should be true! Except the last one…\n\napply(mtcars, 2, is.numeric)\n\n   mpg    cyl   disp     hp   drat     wt   qsec     vs     am   gear   carb \n FALSE  FALSE  FALSE  FALSE  FALSE  FALSE  FALSE  FALSE  FALSE  FALSE  FALSE \nstring \n FALSE \n\n\n\nso better use map_lgl\n\n\n\nCode\nf_ = function(df) {\n  \n  idx = map_lgl(df, function(x) {\n    if (is.numeric(x)) {\n      return(mean(x) &gt; 20)\n    }\n    \n    if (is.character(x)) {\n      return(TRUE)\n    }\n  })\n  return(idx)\n}\n\nmtcars[,f_(mtcars)]\n\n\n                     mpg  disp  hp string\nMazda RX4           21.0 160.0 110      a\nMazda RX4 Wag       21.0 160.0 110      a\nDatsun 710          22.8 108.0  93      a\nHornet 4 Drive      21.4 258.0 110      a\nHornet Sportabout   18.7 360.0 175      a\nValiant             18.1 225.0 105      a\nDuster 360          14.3 360.0 245      a\nMerc 240D           24.4 146.7  62      a\nMerc 230            22.8 140.8  95      a\nMerc 280            19.2 167.6 123      a\nMerc 280C           17.8 167.6 123      a\nMerc 450SE          16.4 275.8 180      a\nMerc 450SL          17.3 275.8 180      a\nMerc 450SLC         15.2 275.8 180      a\nCadillac Fleetwood  10.4 472.0 205      a\nLincoln Continental 10.4 460.0 215      a\nChrysler Imperial   14.7 440.0 230      a\nFiat 128            32.4  78.7  66      a\nHonda Civic         30.4  75.7  52      a\nToyota Corolla      33.9  71.1  65      a\nToyota Corona       21.5 120.1  97      a\nDodge Challenger    15.5 318.0 150      a\nAMC Javelin         15.2 304.0 150      a\nCamaro Z28          13.3 350.0 245      a\nPontiac Firebird    19.2 400.0 175      a\nFiat X1-9           27.3  79.0  66      a\nPorsche 914-2       26.0 120.3  91      a\nLotus Europa        30.4  95.1 113      a\nFord Pantera L      15.8 351.0 264      a\nFerrari Dino        19.7 145.0 175      a\nMaserati Bora       15.0 301.0 335      a\nVolvo 142E          21.4 121.0 109      a\n\n\n\n\n3.3.4 Select Columns if the first value in the column is …\n\n\nCode\nmtcars %&gt;% \n  select(\n    where(\n      function(x)x[[1]] == \"a\"\n    )\n  )\n\n\n                    string\nMazda RX4                a\nMazda RX4 Wag            a\nDatsun 710               a\nHornet 4 Drive           a\nHornet Sportabout        a\nValiant                  a\nDuster 360               a\nMerc 240D                a\nMerc 230                 a\nMerc 280                 a\nMerc 280C                a\nMerc 450SE               a\nMerc 450SL               a\nMerc 450SLC              a\nCadillac Fleetwood       a\nLincoln Continental      a\nChrysler Imperial        a\nFiat 128                 a\nHonda Civic              a\nToyota Corolla           a\nToyota Corona            a\nDodge Challenger         a\nAMC Javelin              a\nCamaro Z28               a\nPontiac Firebird         a\nFiat X1-9                a\nPorsche 914-2            a\nLotus Europa             a\nFord Pantera L           a\nFerrari Dino             a\nMaserati Bora            a\nVolvo 142E               a\n\n\n\n\n3.3.5 where vs “normal” tidy select\nThe docs say about where:\n\nwhere(): Applies a function to all variables and selects those for which the function returns TRUE.\n\nSo it essentially loops over the columns like lapply, whereas a code like this using the selection helpers only looks at the names of the variables:\n\n\nCode\nmtcars %&gt;% select(matches(\"^d\")) %&gt;% head\n\n\n                  disp drat\nMazda RX4          160 3.90\nMazda RX4 Wag      160 3.90\nDatsun 710         108 3.85\nHornet 4 Drive     258 3.08\nHornet Sportabout  360 3.15\nValiant            225 2.76\n\n\nThis works because the “normal” select also takes indexes and by looping over the columns with map_dbl and checking which mean &gt; 10 returns 1 we get the indexes\n\n\nCode\nlibrary(purrr)\nmtcars %&gt;% select(which(map_dbl(.,\n                                ~ mean(.x &gt; 10)) == 1)) %&gt;% head(n=2)\n\n\n              mpg disp  hp  qsec string\nMazda RX4      21  160 110 16.46      a\nMazda RX4 Wag  21  160 110 17.02      a\n\n\nThe same with where just that we need to take care of the string column as the function would return NA and that cant be used as index..\n\n\nCode\nlibrary(purrr)\nmtcars %&gt;% select(where(~mean(.x) &gt; 10 & !is.na(mean(.x))))\n\n\nWarning in mean.default(.x): argument is not numeric or logical: returning NA\n\nWarning in mean.default(.x): argument is not numeric or logical: returning NA\n\n\n                     mpg  disp  hp  qsec\nMazda RX4           21.0 160.0 110 16.46\nMazda RX4 Wag       21.0 160.0 110 17.02\nDatsun 710          22.8 108.0  93 18.61\nHornet 4 Drive      21.4 258.0 110 19.44\nHornet Sportabout   18.7 360.0 175 17.02\nValiant             18.1 225.0 105 20.22\nDuster 360          14.3 360.0 245 15.84\nMerc 240D           24.4 146.7  62 20.00\nMerc 230            22.8 140.8  95 22.90\nMerc 280            19.2 167.6 123 18.30\nMerc 280C           17.8 167.6 123 18.90\nMerc 450SE          16.4 275.8 180 17.40\nMerc 450SL          17.3 275.8 180 17.60\nMerc 450SLC         15.2 275.8 180 18.00\nCadillac Fleetwood  10.4 472.0 205 17.98\nLincoln Continental 10.4 460.0 215 17.82\nChrysler Imperial   14.7 440.0 230 17.42\nFiat 128            32.4  78.7  66 19.47\nHonda Civic         30.4  75.7  52 18.52\nToyota Corolla      33.9  71.1  65 19.90\nToyota Corona       21.5 120.1  97 20.01\nDodge Challenger    15.5 318.0 150 16.87\nAMC Javelin         15.2 304.0 150 17.30\nCamaro Z28          13.3 350.0 245 15.41\nPontiac Firebird    19.2 400.0 175 17.05\nFiat X1-9           27.3  79.0  66 18.90\nPorsche 914-2       26.0 120.3  91 16.70\nLotus Europa        30.4  95.1 113 16.90\nFord Pantera L      15.8 351.0 264 14.50\nFerrari Dino        19.7 145.0 175 15.50\nMaserati Bora       15.0 301.0 335 14.60\nVolvo 142E          21.4 121.0 109 18.60"
  },
  {
    "objectID": "dplyr.html#where-vs-normal-tidy-select",
    "href": "dplyr.html#where-vs-normal-tidy-select",
    "title": "3  Dplyr",
    "section": "3.4 where vs “normal” tidy select",
    "text": "3.4 where vs “normal” tidy select\nThe docs say about where:\n\nwhere(): Applies a function to all variables and selects those for which the function returns TRUE.\n\nSo it essentially loops over the columns like lapply, whereas a code like this using the selection helpers only looks at the names of the variables:\n\n\nCode\nmtcars %&gt;% select(matches(\"^d\")) %&gt;% head\n\n\n                  disp drat\nMazda RX4          160 3.90\nMazda RX4 Wag      160 3.90\nDatsun 710         108 3.85\nHornet 4 Drive     258 3.08\nHornet Sportabout  360 3.15\nValiant            225 2.76\n\n\nThis works because the “normal” select also takes indexes and by looping over the columns with map_dbl and checking which mean &gt; 10 returns 1 we get the indexes\n\n\nCode\nlibrary(purrr)\nmtcars %&gt;% select(which(map_dbl(.,\n                                ~ mean(.x &gt; 10)) == 1)) %&gt;% head(n=2)\n\n\n              mpg disp  hp  qsec string\nMazda RX4      21  160 110 16.46      a\nMazda RX4 Wag  21  160 110 17.02      a\n\n\nThe same with where just that we need to take care of the string column as the function would return NA and that cant be used as index..\n\n\nCode\nlibrary(purrr)\nmtcars %&gt;% select(where(~mean(.x) &gt; 10 & !is.na(mean(.x))))\n\n\nWarning in mean.default(.x): argument is not numeric or logical: returning NA\n\nWarning in mean.default(.x): argument is not numeric or logical: returning NA\n\n\n                     mpg  disp  hp  qsec\nMazda RX4           21.0 160.0 110 16.46\nMazda RX4 Wag       21.0 160.0 110 17.02\nDatsun 710          22.8 108.0  93 18.61\nHornet 4 Drive      21.4 258.0 110 19.44\nHornet Sportabout   18.7 360.0 175 17.02\nValiant             18.1 225.0 105 20.22\nDuster 360          14.3 360.0 245 15.84\nMerc 240D           24.4 146.7  62 20.00\nMerc 230            22.8 140.8  95 22.90\nMerc 280            19.2 167.6 123 18.30\nMerc 280C           17.8 167.6 123 18.90\nMerc 450SE          16.4 275.8 180 17.40\nMerc 450SL          17.3 275.8 180 17.60\nMerc 450SLC         15.2 275.8 180 18.00\nCadillac Fleetwood  10.4 472.0 205 17.98\nLincoln Continental 10.4 460.0 215 17.82\nChrysler Imperial   14.7 440.0 230 17.42\nFiat 128            32.4  78.7  66 19.47\nHonda Civic         30.4  75.7  52 18.52\nToyota Corolla      33.9  71.1  65 19.90\nToyota Corona       21.5 120.1  97 20.01\nDodge Challenger    15.5 318.0 150 16.87\nAMC Javelin         15.2 304.0 150 17.30\nCamaro Z28          13.3 350.0 245 15.41\nPontiac Firebird    19.2 400.0 175 17.05\nFiat X1-9           27.3  79.0  66 18.90\nPorsche 914-2       26.0 120.3  91 16.70\nLotus Europa        30.4  95.1 113 16.90\nFord Pantera L      15.8 351.0 264 14.50\nFerrari Dino        19.7 145.0 175 15.50\nMaserati Bora       15.0 301.0 335 14.60\nVolvo 142E          21.4 121.0 109 18.60"
  },
  {
    "objectID": "dplyr.html#filtering-rows",
    "href": "dplyr.html#filtering-rows",
    "title": "3  Dplyr",
    "section": "3.4 Filtering Rows",
    "text": "3.4 Filtering Rows"
  },
  {
    "objectID": "dplyr.html#rowwise-compute-new-column-with-subset-of-existing-columns",
    "href": "dplyr.html#rowwise-compute-new-column-with-subset-of-existing-columns",
    "title": "3  Dplyr",
    "section": "3.6 Rowwise Compute new Column with subset of existing columns",
    "text": "3.6 Rowwise Compute new Column with subset of existing columns\n\n\nCode\n# pmap loops over multiple lists|vectors at the same time\n# in this case all the numeric columns in mtcars\n# the ~median(c(...)) says take all the cols\nmtcars %&gt;% \n  mutate(\n    med = pmap_dbl(select(., where(is.numeric)), ~median(c(...), na.rm = T))\n  )  %&gt;% glimpse\n\n\nRows: 32\nColumns: 13\n$ mpg    &lt;dbl&gt; 21.0, 21.0, 22.8, 21.4, 18.7, 18.1, 14.3, 24.4, 22.8, 19.2, 17.…\n$ cyl    &lt;dbl&gt; 6, 6, 4, 6, 8, 6, 8, 4, 4, 6, 6, 8, 8, 8, 8, 8, 8, 4, 4, 4, 4, …\n$ disp   &lt;dbl&gt; 160.0, 160.0, 108.0, 258.0, 360.0, 225.0, 360.0, 146.7, 140.8, …\n$ hp     &lt;dbl&gt; 110, 110, 93, 110, 175, 105, 245, 62, 95, 123, 123, 180, 180, 1…\n$ drat   &lt;dbl&gt; 3.90, 3.90, 3.85, 3.08, 3.15, 2.76, 3.21, 3.69, 3.92, 3.92, 3.9…\n$ wt     &lt;dbl&gt; 2.620, 2.875, 2.320, 3.215, 3.440, 3.460, 3.570, 3.190, 3.150, …\n$ qsec   &lt;dbl&gt; 16.46, 17.02, 18.61, 19.44, 17.02, 20.22, 15.84, 20.00, 22.90, …\n$ vs     &lt;dbl&gt; 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, …\n$ am     &lt;dbl&gt; 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, …\n$ gear   &lt;dbl&gt; 4, 4, 4, 3, 3, 3, 3, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 4, 4, 4, 3, …\n$ carb   &lt;dbl&gt; 4, 4, 1, 1, 2, 1, 4, 2, 2, 4, 4, 3, 3, 3, 4, 4, 4, 1, 2, 1, 1, …\n$ string &lt;chr&gt; \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\"…\n$ med    &lt;dbl&gt; 4.000, 4.000, 4.000, 3.215, 3.440, 3.460, 4.000, 4.000, 4.000, …"
  },
  {
    "objectID": "dplyr.html#adding-column-indicating-if-group-if-max-value-in-group-is-in-top-n-max-values-per-group",
    "href": "dplyr.html#adding-column-indicating-if-group-if-max-value-in-group-is-in-top-n-max-values-per-group",
    "title": "3  Dplyr",
    "section": "3.6 Adding column indicating if group if max value in group is in top-n max values per group",
    "text": "3.6 Adding column indicating if group if max value in group is in top-n max values per group\nSteps: \n\ngroup_by the grouping variable\nsummarise get the max value per group\ninner_join the result with the original data-frame\n\n\n\nCode\n# which of the cyl-groups  contains the highest disp\n\ntop = mtcars %&gt;%\n  group_by(cyl) %&gt;%\n  summarise(m = max(disp)) %&gt;%\n  arrange(desc(m)) %&gt;%\n  ungroup() %&gt;%\n  mutate(top2 = if_else(row_number() == 1, T, F)) %&gt;% \n  inner_join(\n    ., mtcars, by=c(\"cyl\")\n  )\ntop\n\n\n# A tibble: 32 × 14\n     cyl     m top2    mpg  disp    hp  drat    wt  qsec    vs    am  gear  carb\n   &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n 1     8   472 TRUE   18.7  360    175  3.15  3.44  17.0     0     0     3     2\n 2     8   472 TRUE   14.3  360    245  3.21  3.57  15.8     0     0     3     4\n 3     8   472 TRUE   16.4  276.   180  3.07  4.07  17.4     0     0     3     3\n 4     8   472 TRUE   17.3  276.   180  3.07  3.73  17.6     0     0     3     3\n 5     8   472 TRUE   15.2  276.   180  3.07  3.78  18       0     0     3     3\n 6     8   472 TRUE   10.4  472    205  2.93  5.25  18.0     0     0     3     4\n 7     8   472 TRUE   10.4  460    215  3     5.42  17.8     0     0     3     4\n 8     8   472 TRUE   14.7  440    230  3.23  5.34  17.4     0     0     3     4\n 9     8   472 TRUE   15.5  318    150  2.76  3.52  16.9     0     0     3     2\n10     8   472 TRUE   15.2  304    150  3.15  3.44  17.3     0     0     3     2\n# ℹ 22 more rows\n# ℹ 1 more variable: string &lt;chr&gt;\n\n\n\n3.6.0.0.1 example of STACKOVERFLOW\n\n\nCode\ndf = structure(list(id = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, \n2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, \n4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, \n6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, \n8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9), year = c(\"2017\", \"2018\", \n\"2019\", \"2020\", \"2021\", \"2022\", \"2023\", \"2024\", \"2025\", \"2026\", \n\"2017\", \"2018\", \"2019\", \"2020\", \"2021\", \"2022\", \"2023\", \"2024\", \n\"2025\", \"2026\", \"2017\", \"2018\", \"2019\", \"2020\", \"2021\", \"2022\", \n\"2023\", \"2024\", \"2025\", \"2026\", \"2017\", \"2018\", \"2019\", \"2020\", \n\"2021\", \"2022\", \"2023\", \"2024\", \"2025\", \"2026\", \"2017\", \"2018\", \n\"2019\", \"2020\", \"2021\", \"2022\", \"2023\", \"2024\", \"2025\", \"2026\", \n\"2017\", \"2018\", \"2019\", \"2020\", \"2021\", \"2022\", \"2023\", \"2024\", \n\"2025\", \"2026\", \"2017\", \"2018\", \"2019\", \"2020\", \"2021\", \"2022\", \n\"2023\", \"2024\", \"2025\", \"2026\", \"2017\", \"2018\", \"2019\", \"2020\", \n\"2021\", \"2022\", \"2023\", \"2024\", \"2025\", \"2026\", \"2017\", \"2018\", \n\"2019\", \"2020\", \"2021\", \"2022\", \"2023\", \"2024\", \"2025\", \"2026\"\n), volume = c(0.0013, 0.0013, 0.0012579, 0.0011895, 0.0011421, \n0.0010842, 0.0010211, 0.0010158, 0.00099474, 0.00092632, 0.07878, \n0.078791, 0.077295, 0.076638, 0.075538, 0.074468, 0.074776, 0.074051, \n0.071706, 0.068056, 0.023269, 0.023011, 0.022374, 0.021962, 0.021408, \n0.020949, 0.020811, 0.020354, 0.019309, 0.018042, 0.0004, 0.0004, \n0.00038421, 0.00035263, 0.00033158, 0.00032105, 0.00026842, 0.00028421, \n0.00026842, 0.00024211, 0.0002, 0.0001, 0.00011579, 0, 0, 0, \n0, 0, 0, 0, 0.028422, 0.028361, 0.027768, 0.027501, 0.027029, \n0.02651, 0.026588, 0.026209, 0.025094, 0.023391, 0.0001, 0.0001, \n0, 0, 0, 0, 0, 0, 0, 0, 0.0047, 0.0047158, 0.0048368, 0.0048316, \n0.0049263, 0.0049737, 0.0049947, 0.0051684, 0.0052526, 0.0051842, \n0.0106, 0.010389, 0.010279, 0.010005, 0.0098421, 0.0096368, 0.0094053, \n0.0093368, 0.0092526, 0.0089316)), class = c(\"tbl_df\", \"tbl\", \n\"data.frame\"), row.names = c(NA, -90L))\n\ndf %&gt;%\n  group_by(id) %&gt;%\n  summarise(m = max(volume)) %&gt;%\n  arrange(desc(m)) %&gt;%\n  mutate(top3 = if_else(row_number() %in% c(1, 2, 3), T, F)) %&gt;%\n  inner_join(., df, by = c(\"id\")) -&gt; top123"
  },
  {
    "objectID": "dplyr.html#list-columns-and-dplyr",
    "href": "dplyr.html#list-columns-and-dplyr",
    "title": "3  Dplyr",
    "section": "3.7 list Columns (and dplyr)",
    "text": "3.7 list Columns (and dplyr)\n\ntibbles and dataframes are lists of vectors!!\n\n\n\nCode\nl = tibble::tibble(x = runif(10),\n                   y = 1:10)\n\ntypeof(l)\n\n\n[1] \"list\"\n\n\n image source:\n\nMeaning each column is a vector. Usually these are atomic vectors (recall chapter .. TODO in advanced R..), but these can also be lists.\n\n image source:\n\nList columns are much more versatile than atomic vectors. They can contain atomic vectors, other lists, tibbles, …\n\n\n3.7.1 Creating List Columns\n\nIt seems to be common to create list columns by modifying an existing “normal” tibble. Three common ways are:\n\nnest()\nsummarise and list\nmutate and map\n\n\n\n3.7.1.1 nest()\n\nWhen calling nest the first argument is the new column-name. In this case it is cars.\nThe second argument are the columns you want to have in the resulting dataframe in each element of the list column.\nEach column you do not specify automatically becomes a grouping variable and all the resulting tibble will have as many rows as unique combinations in these grouping variables there are.\n\n\n\nCode\nmtcars_with_list_col = mtcars %&gt;%\n  mutate(name = rownames(.)) %&gt;%\n  select(cyl, mpg, name) %&gt;%\n  nest(cars = c(mpg, name))\n\n# inspect it\nstr(mtcars_with_list_col)\n\n\ntibble [3 × 2] (S3: tbl_df/tbl/data.frame)\n $ cyl : num [1:3] 6 4 8\n $ cars:List of 3\n  ..$ : tibble [7 × 2] (S3: tbl_df/tbl/data.frame)\n  .. ..$ mpg : num [1:7] 21 21 21.4 18.1 19.2 17.8 19.7\n  .. ..$ name: chr [1:7] \"Mazda RX4\" \"Mazda RX4 Wag\" \"Hornet 4 Drive\" \"Valiant\" ...\n  ..$ : tibble [11 × 2] (S3: tbl_df/tbl/data.frame)\n  .. ..$ mpg : num [1:11] 22.8 24.4 22.8 32.4 30.4 33.9 21.5 27.3 26 30.4 ...\n  .. ..$ name: chr [1:11] \"Datsun 710\" \"Merc 240D\" \"Merc 230\" \"Fiat 128\" ...\n  ..$ : tibble [14 × 2] (S3: tbl_df/tbl/data.frame)\n  .. ..$ mpg : num [1:14] 18.7 14.3 16.4 17.3 15.2 10.4 10.4 14.7 15.5 15.2 ...\n  .. ..$ name: chr [1:14] \"Hornet Sportabout\" \"Duster 360\" \"Merc 450SE\" \"Merc 450SL\" ...\n\n\n\n\n3.7.1.2 summarise and list\n\nNormally you use group_by and summarise to collapse groups into single rows.\nYou can also use group_by, summarise and list to create atomic vectors where each vector corresponds to one group of cyl\n\n\n\nCode\nmtcars_names_per_cyl = mtcars %&gt;%\n  mutate(name = rownames(.)) %&gt;%\n  group_by(cyl) %&gt;%\n  summarise(cars_per_cyl = list(name))\n\n\n\nWhat if you want to manipulate each vector before putting it into the list column\n\n\n\nCode\nmtcars_names_per_cyl_sorted = mtcars %&gt;%\n  mutate(name = rownames(.)) %&gt;%\n  group_by(cyl) %&gt;%\n  summarise(cars_per_cyl = list(sort(name)))\n\n\n\n\n3.7.1.3 mutate and map\n\n\nCode\nn_values_per_car_letter = mtcars %&gt;%\n  mutate(name = rownames(.)) %&gt;%\n  mutate(random = map(name, ~ rnorm(n = str_length(.x)))) %&gt;%\n  select(name, random)\n\nstr(n_values_per_car_letter)  \n\n\n'data.frame':   32 obs. of  2 variables:\n $ name  : chr  \"Mazda RX4\" \"Mazda RX4 Wag\" \"Datsun 710\" \"Hornet 4 Drive\" ...\n $ random:List of 32\n  ..$ : num  -0.195 -0.184 -1.368 0.846 2.033 ...\n  ..$ : num  1.95 -1.198 0.853 -0.767 -0.574 ...\n  ..$ : num  1.78 1.217 0.113 0.972 0.736 ...\n  ..$ : num  0.269288 -0.000404 1.121984 -1.387668 -0.210925 ...\n  ..$ : num  0.2822 -1.1945 1.0201 0.054 -0.0213 ...\n  ..$ : num  -0.0744 -1.1625 0.7702 -0.1963 0.2054 ...\n  ..$ : num  1.981 -1.106 -0.361 1.077 -0.934 ...\n  ..$ : num  -0.0841 0.7739 -0.0121 0.6751 -1.5646 ...\n  ..$ : num  -1.904 -1.699 -1.12 0.486 -1.186 ...\n  ..$ : num  -1.406 -0.23 2.439 -0.539 0.339 ...\n  ..$ : num  0.586 -0.797 0.342 -1.053 -1.277 ...\n  ..$ : num  0.6337 0.2869 -0.4436 -1.3288 0.0312 ...\n  ..$ : num  1.232 0.246 -0.746 -1.04 -1.523 ...\n  ..$ : num  -0.9038 -0.5822 0.3398 0.0425 0.6088 ...\n  ..$ : num  -0.281 -1.098 0.493 0.063 -0.245 ...\n  ..$ : num  -0.62 1.7 -1.036 0.302 0.788 ...\n  ..$ : num  0.204 -1.111 0.251 1.865 -0.609 ...\n  ..$ : num  -0.0874 1.3393 0.291 1.0198 0.2712 ...\n  ..$ : num  -0.986 0.64 -2.273 -1.432 -0.485 ...\n  ..$ : num  0.563189 0.879347 0.337097 -0.360936 0.000299 ...\n  ..$ : num  -0.98 -0.149 2.472 -1.621 -0.935 ...\n  ..$ : num  -0.332 0.066 1.237 0.946 0.119 ...\n  ..$ : num  0.3958 0.0535 -0.4067 -1.2724 -0.2164 ...\n  ..$ : num  0.127 0.814 0.698 1.298 0.927 ...\n  ..$ : num  -0.9758 -0.0991 1.136 -0.8737 0.1375 ...\n  ..$ : num  -1.091 -0.453 -0.488 0.77 1.143 ...\n  ..$ : num  0.06291 1.41201 0.00426 0.57423 2.00933 ...\n  ..$ : num  -0.661 -0.408 -0.175 -1.412 -0.545 ...\n  ..$ : num  -1.233 -0.819 1.935 0.673 1.778 ...\n  ..$ : num  0.632 0.865 -1.132 0.926 0.468 ...\n  ..$ : num  -1.128 -0.472 -1.043 0.193 -0.249 ...\n  ..$ : num  -0.92 0.112 -0.135 -1.688 -1.949 ...\n\n\n\n\n\n3.7.2 Manipulating\n\nsay you want to get the number of rows for each data.frame in a list column\n\nVersion 1\n\n\nCode\nmtcars %&gt;%\n  mutate(name = rownames(.)) %&gt;%\n  nest(data_per_cyl = !cyl) %&gt;% \n  mutate(\n    nrow_per_cyl = map_dbl(data_per_cyl, nrow)\n  )\n\n\n# A tibble: 3 × 3\n    cyl data_per_cyl       nrow_per_cyl\n  &lt;dbl&gt; &lt;list&gt;                    &lt;dbl&gt;\n1     6 &lt;tibble [7 × 12]&gt;             7\n2     4 &lt;tibble [11 × 12]&gt;           11\n3     8 &lt;tibble [14 × 12]&gt;           14\n\n\nVersion 2\n\nusig rowwise\n\n\n\nCode\nmtcars %&gt;%\n  mutate(name = rownames(.)) %&gt;%\n  nest(data_per_cyl = !cyl) %&gt;% \n  rowwise() %&gt;%\n  mutate(\n    nrow_per_cyl = nrow(data_per_cyl)\n  )\n\n\n# A tibble: 3 × 3\n# Rowwise: \n    cyl data_per_cyl       nrow_per_cyl\n  &lt;dbl&gt; &lt;list&gt;                    &lt;int&gt;\n1     6 &lt;tibble [7 × 12]&gt;             7\n2     4 &lt;tibble [11 × 12]&gt;           11\n3     8 &lt;tibble [14 × 12]&gt;           14"
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "2  Intro",
    "section": "",
    "text": "This creates a new environment\n\n\nsuppressMessages(attach(mtcars)) \nplot(mpg, cyl)\n\n\n\nsearch() # list search paths for r objects -> the mtcars object is now a search path\n\n [1] \".GlobalEnv\"        \"mtcars\"            \"tools:quarto\"     \n [4] \"package:stats\"     \"package:graphics\"  \"package:grDevices\"\n [7] \"package:utils\"     \"package:datasets\"  \"package:methods\"  \n[10] \"Autoloads\"         \"package:base\"     \n\n# http://adv-r.had.co.nz/Environments.html\nls(envir=as.environment(mtcars))\n\n [1] \"am\"   \"carb\" \"cyl\"  \"disp\" \"drat\" \"gear\" \"hp\"   \"mpg\"  \"qsec\" \"vs\"  \n[11] \"wt\""
  },
  {
    "objectID": "mapping.html",
    "href": "mapping.html",
    "title": "5  Mapping",
    "section": "",
    "text": "── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.3.6     ✔ purrr   0.3.4\n✔ tibble  3.1.8     ✔ dplyr   1.0.9\n✔ tidyr   1.2.0     ✔ stringr 1.4.0\n✔ readr   2.1.2     ✔ forcats 0.5.1\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()"
  },
  {
    "objectID": "mapping.html#baseapply",
    "href": "mapping.html#baseapply",
    "title": "4  Mapping",
    "section": "4.1 base::apply",
    "text": "4.1 base::apply"
  },
  {
    "objectID": "mapping.html#purrmap",
    "href": "mapping.html#purrmap",
    "title": "4  Mapping",
    "section": "4.2 purr::map",
    "text": "4.2 purr::map\n\n4.2.1 Find the number of NAs per column in a dataframe\n\n\nCode\npurrr::map(mtcars %&gt;% select(where(is.numeric)), ~sum(is.na(.x)))\n\n\n$mpg\n[1] 0\n\n$cyl\n[1] 0\n\n$disp\n[1] 0\n\n$hp\n[1] 0\n\n$drat\n[1] 0\n\n$wt\n[1] 0\n\n$qsec\n[1] 0\n\n$vs\n[1] 0\n\n$am\n[1] 0\n\n$gear\n[1] 0\n\n$carb\n[1] 0"
  },
  {
    "objectID": "mapping.html#purrrmap2",
    "href": "mapping.html#purrrmap2",
    "title": "4  Mapping",
    "section": "4.3 purrr::map2",
    "text": "4.3 purrr::map2\n\n\nCode\ndf =\n  tibble(\n    a = c(1, 2, 4),\n    b = c(6, 5, 3)\n  )\n\n\ndf %&gt;% \n  mutate(\n    min_a_b = map2_dbl(a,b,min)\n  )\n\n\n# A tibble: 3 × 3\n      a     b min_a_b\n  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;\n1     1     6       1\n2     2     5       2\n3     4     3       3\n\n\nBy default, mutate() uses column-wise operations. map2_dbl() produces a column the same length at a and b. We can accomplish the same calculation using row-wise operations.\n\n\nCode\ndf %&gt;%\n  rowwise() %&gt;%\n  mutate(min = min(a, b)) %&gt;% ungroup()\n\n\n# A tibble: 3 × 3\n      a     b   min\n  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1     1     6     1\n2     2     5     2\n3     4     3     3"
  },
  {
    "objectID": "mapping.html#purrrpmap",
    "href": "mapping.html#purrrpmap",
    "title": "4  Mapping",
    "section": "4.4 purrr::pmap",
    "text": "4.4 purrr::pmap\n\ntakes an arbitrary amout of lists as input.\nHowever:\n\n\nThe actual input to purrr::map is  ONE SINGLE LIST \n\n\n\nCode\nl1 = list(a = 1, b=2, c=3)\nl2 = list(a = 11, b=22, c=33)\nl3 = list(a = 111, b=222, c=333)\n\nl123 = list(l1, l2, l3)\n\n# go over the three lists in parallel and each time select the minimal value\npurrr::pmap(l123, min)\n\n\n$a\n[1] 1\n\n$b\n[1] 2\n\n$c\n[1] 3\n\n\nCode\n# same as the first, goes over all inputs\npurrr::pmap(l123, ~min(c(...)))\n\n\n$a\n[1] 1\n\n$b\n[1] 2\n\n$c\n[1] 3\n\n\nCode\n# only go over the first two\npurrr::pmap(l123, ~min(..2, ..3))\n\n\n$a\n[1] 11\n\n$b\n[1] 22\n\n$c\n[1] 33\n\n\n\n4.4.1 Count the number of numeric columns\n\n\nCode\n# count the numeric columns\n\nmtcars %&gt;% \n  mutate(\n    min_numeric = pmap_dbl(select(., where(is.numeric)), ~length(c(...)))\n  ) %&gt;% glimpse\n\n\nRows: 32\nColumns: 12\n$ mpg         &lt;dbl&gt; 21.0, 21.0, 22.8, 21.4, 18.7, 18.1, 14.3, 24.4, 22.8, 19.2…\n$ cyl         &lt;dbl&gt; 6, 6, 4, 6, 8, 6, 8, 4, 4, 6, 6, 8, 8, 8, 8, 8, 8, 4, 4, 4…\n$ disp        &lt;dbl&gt; 160.0, 160.0, 108.0, 258.0, 360.0, 225.0, 360.0, 146.7, 14…\n$ hp          &lt;dbl&gt; 110, 110, 93, 110, 175, 105, 245, 62, 95, 123, 123, 180, 1…\n$ drat        &lt;dbl&gt; 3.90, 3.90, 3.85, 3.08, 3.15, 2.76, 3.21, 3.69, 3.92, 3.92…\n$ wt          &lt;dbl&gt; 2.620, 2.875, 2.320, 3.215, 3.440, 3.460, 3.570, 3.190, 3.…\n$ qsec        &lt;dbl&gt; 16.46, 17.02, 18.61, 19.44, 17.02, 20.22, 15.84, 20.00, 22…\n$ vs          &lt;dbl&gt; 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1…\n$ am          &lt;dbl&gt; 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1…\n$ gear        &lt;dbl&gt; 4, 4, 4, 3, 3, 3, 3, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 4, 4, 4…\n$ carb        &lt;dbl&gt; 4, 4, 1, 1, 2, 1, 4, 2, 2, 4, 4, 3, 3, 3, 4, 4, 4, 1, 2, 1…\n$ min_numeric &lt;dbl&gt; 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11…\n\n\n\n\n4.4.2 turn each row into a list\n\n\nCode\n# mtcars is a list (a dataframe) with 12 elements, iteratre simultaneously over each of them\nready_for_d3 = purrr::pmap(mtcars, list)\nstr(ready_for_d3)\n\n\nList of 32\n $ :List of 11\n  ..$ mpg : num 21\n  ..$ cyl : num 6\n  ..$ disp: num 160\n  ..$ hp  : num 110\n  ..$ drat: num 3.9\n  ..$ wt  : num 2.62\n  ..$ qsec: num 16.5\n  ..$ vs  : num 0\n  ..$ am  : num 1\n  ..$ gear: num 4\n  ..$ carb: num 4\n $ :List of 11\n  ..$ mpg : num 21\n  ..$ cyl : num 6\n  ..$ disp: num 160\n  ..$ hp  : num 110\n  ..$ drat: num 3.9\n  ..$ wt  : num 2.88\n  ..$ qsec: num 17\n  ..$ vs  : num 0\n  ..$ am  : num 1\n  ..$ gear: num 4\n  ..$ carb: num 4\n $ :List of 11\n  ..$ mpg : num 22.8\n  ..$ cyl : num 4\n  ..$ disp: num 108\n  ..$ hp  : num 93\n  ..$ drat: num 3.85\n  ..$ wt  : num 2.32\n  ..$ qsec: num 18.6\n  ..$ vs  : num 1\n  ..$ am  : num 1\n  ..$ gear: num 4\n  ..$ carb: num 1\n $ :List of 11\n  ..$ mpg : num 21.4\n  ..$ cyl : num 6\n  ..$ disp: num 258\n  ..$ hp  : num 110\n  ..$ drat: num 3.08\n  ..$ wt  : num 3.21\n  ..$ qsec: num 19.4\n  ..$ vs  : num 1\n  ..$ am  : num 0\n  ..$ gear: num 3\n  ..$ carb: num 1\n $ :List of 11\n  ..$ mpg : num 18.7\n  ..$ cyl : num 8\n  ..$ disp: num 360\n  ..$ hp  : num 175\n  ..$ drat: num 3.15\n  ..$ wt  : num 3.44\n  ..$ qsec: num 17\n  ..$ vs  : num 0\n  ..$ am  : num 0\n  ..$ gear: num 3\n  ..$ carb: num 2\n $ :List of 11\n  ..$ mpg : num 18.1\n  ..$ cyl : num 6\n  ..$ disp: num 225\n  ..$ hp  : num 105\n  ..$ drat: num 2.76\n  ..$ wt  : num 3.46\n  ..$ qsec: num 20.2\n  ..$ vs  : num 1\n  ..$ am  : num 0\n  ..$ gear: num 3\n  ..$ carb: num 1\n $ :List of 11\n  ..$ mpg : num 14.3\n  ..$ cyl : num 8\n  ..$ disp: num 360\n  ..$ hp  : num 245\n  ..$ drat: num 3.21\n  ..$ wt  : num 3.57\n  ..$ qsec: num 15.8\n  ..$ vs  : num 0\n  ..$ am  : num 0\n  ..$ gear: num 3\n  ..$ carb: num 4\n $ :List of 11\n  ..$ mpg : num 24.4\n  ..$ cyl : num 4\n  ..$ disp: num 147\n  ..$ hp  : num 62\n  ..$ drat: num 3.69\n  ..$ wt  : num 3.19\n  ..$ qsec: num 20\n  ..$ vs  : num 1\n  ..$ am  : num 0\n  ..$ gear: num 4\n  ..$ carb: num 2\n $ :List of 11\n  ..$ mpg : num 22.8\n  ..$ cyl : num 4\n  ..$ disp: num 141\n  ..$ hp  : num 95\n  ..$ drat: num 3.92\n  ..$ wt  : num 3.15\n  ..$ qsec: num 22.9\n  ..$ vs  : num 1\n  ..$ am  : num 0\n  ..$ gear: num 4\n  ..$ carb: num 2\n $ :List of 11\n  ..$ mpg : num 19.2\n  ..$ cyl : num 6\n  ..$ disp: num 168\n  ..$ hp  : num 123\n  ..$ drat: num 3.92\n  ..$ wt  : num 3.44\n  ..$ qsec: num 18.3\n  ..$ vs  : num 1\n  ..$ am  : num 0\n  ..$ gear: num 4\n  ..$ carb: num 4\n $ :List of 11\n  ..$ mpg : num 17.8\n  ..$ cyl : num 6\n  ..$ disp: num 168\n  ..$ hp  : num 123\n  ..$ drat: num 3.92\n  ..$ wt  : num 3.44\n  ..$ qsec: num 18.9\n  ..$ vs  : num 1\n  ..$ am  : num 0\n  ..$ gear: num 4\n  ..$ carb: num 4\n $ :List of 11\n  ..$ mpg : num 16.4\n  ..$ cyl : num 8\n  ..$ disp: num 276\n  ..$ hp  : num 180\n  ..$ drat: num 3.07\n  ..$ wt  : num 4.07\n  ..$ qsec: num 17.4\n  ..$ vs  : num 0\n  ..$ am  : num 0\n  ..$ gear: num 3\n  ..$ carb: num 3\n $ :List of 11\n  ..$ mpg : num 17.3\n  ..$ cyl : num 8\n  ..$ disp: num 276\n  ..$ hp  : num 180\n  ..$ drat: num 3.07\n  ..$ wt  : num 3.73\n  ..$ qsec: num 17.6\n  ..$ vs  : num 0\n  ..$ am  : num 0\n  ..$ gear: num 3\n  ..$ carb: num 3\n $ :List of 11\n  ..$ mpg : num 15.2\n  ..$ cyl : num 8\n  ..$ disp: num 276\n  ..$ hp  : num 180\n  ..$ drat: num 3.07\n  ..$ wt  : num 3.78\n  ..$ qsec: num 18\n  ..$ vs  : num 0\n  ..$ am  : num 0\n  ..$ gear: num 3\n  ..$ carb: num 3\n $ :List of 11\n  ..$ mpg : num 10.4\n  ..$ cyl : num 8\n  ..$ disp: num 472\n  ..$ hp  : num 205\n  ..$ drat: num 2.93\n  ..$ wt  : num 5.25\n  ..$ qsec: num 18\n  ..$ vs  : num 0\n  ..$ am  : num 0\n  ..$ gear: num 3\n  ..$ carb: num 4\n $ :List of 11\n  ..$ mpg : num 10.4\n  ..$ cyl : num 8\n  ..$ disp: num 460\n  ..$ hp  : num 215\n  ..$ drat: num 3\n  ..$ wt  : num 5.42\n  ..$ qsec: num 17.8\n  ..$ vs  : num 0\n  ..$ am  : num 0\n  ..$ gear: num 3\n  ..$ carb: num 4\n $ :List of 11\n  ..$ mpg : num 14.7\n  ..$ cyl : num 8\n  ..$ disp: num 440\n  ..$ hp  : num 230\n  ..$ drat: num 3.23\n  ..$ wt  : num 5.34\n  ..$ qsec: num 17.4\n  ..$ vs  : num 0\n  ..$ am  : num 0\n  ..$ gear: num 3\n  ..$ carb: num 4\n $ :List of 11\n  ..$ mpg : num 32.4\n  ..$ cyl : num 4\n  ..$ disp: num 78.7\n  ..$ hp  : num 66\n  ..$ drat: num 4.08\n  ..$ wt  : num 2.2\n  ..$ qsec: num 19.5\n  ..$ vs  : num 1\n  ..$ am  : num 1\n  ..$ gear: num 4\n  ..$ carb: num 1\n $ :List of 11\n  ..$ mpg : num 30.4\n  ..$ cyl : num 4\n  ..$ disp: num 75.7\n  ..$ hp  : num 52\n  ..$ drat: num 4.93\n  ..$ wt  : num 1.61\n  ..$ qsec: num 18.5\n  ..$ vs  : num 1\n  ..$ am  : num 1\n  ..$ gear: num 4\n  ..$ carb: num 2\n $ :List of 11\n  ..$ mpg : num 33.9\n  ..$ cyl : num 4\n  ..$ disp: num 71.1\n  ..$ hp  : num 65\n  ..$ drat: num 4.22\n  ..$ wt  : num 1.83\n  ..$ qsec: num 19.9\n  ..$ vs  : num 1\n  ..$ am  : num 1\n  ..$ gear: num 4\n  ..$ carb: num 1\n $ :List of 11\n  ..$ mpg : num 21.5\n  ..$ cyl : num 4\n  ..$ disp: num 120\n  ..$ hp  : num 97\n  ..$ drat: num 3.7\n  ..$ wt  : num 2.46\n  ..$ qsec: num 20\n  ..$ vs  : num 1\n  ..$ am  : num 0\n  ..$ gear: num 3\n  ..$ carb: num 1\n $ :List of 11\n  ..$ mpg : num 15.5\n  ..$ cyl : num 8\n  ..$ disp: num 318\n  ..$ hp  : num 150\n  ..$ drat: num 2.76\n  ..$ wt  : num 3.52\n  ..$ qsec: num 16.9\n  ..$ vs  : num 0\n  ..$ am  : num 0\n  ..$ gear: num 3\n  ..$ carb: num 2\n $ :List of 11\n  ..$ mpg : num 15.2\n  ..$ cyl : num 8\n  ..$ disp: num 304\n  ..$ hp  : num 150\n  ..$ drat: num 3.15\n  ..$ wt  : num 3.44\n  ..$ qsec: num 17.3\n  ..$ vs  : num 0\n  ..$ am  : num 0\n  ..$ gear: num 3\n  ..$ carb: num 2\n $ :List of 11\n  ..$ mpg : num 13.3\n  ..$ cyl : num 8\n  ..$ disp: num 350\n  ..$ hp  : num 245\n  ..$ drat: num 3.73\n  ..$ wt  : num 3.84\n  ..$ qsec: num 15.4\n  ..$ vs  : num 0\n  ..$ am  : num 0\n  ..$ gear: num 3\n  ..$ carb: num 4\n $ :List of 11\n  ..$ mpg : num 19.2\n  ..$ cyl : num 8\n  ..$ disp: num 400\n  ..$ hp  : num 175\n  ..$ drat: num 3.08\n  ..$ wt  : num 3.85\n  ..$ qsec: num 17.1\n  ..$ vs  : num 0\n  ..$ am  : num 0\n  ..$ gear: num 3\n  ..$ carb: num 2\n $ :List of 11\n  ..$ mpg : num 27.3\n  ..$ cyl : num 4\n  ..$ disp: num 79\n  ..$ hp  : num 66\n  ..$ drat: num 4.08\n  ..$ wt  : num 1.94\n  ..$ qsec: num 18.9\n  ..$ vs  : num 1\n  ..$ am  : num 1\n  ..$ gear: num 4\n  ..$ carb: num 1\n $ :List of 11\n  ..$ mpg : num 26\n  ..$ cyl : num 4\n  ..$ disp: num 120\n  ..$ hp  : num 91\n  ..$ drat: num 4.43\n  ..$ wt  : num 2.14\n  ..$ qsec: num 16.7\n  ..$ vs  : num 0\n  ..$ am  : num 1\n  ..$ gear: num 5\n  ..$ carb: num 2\n $ :List of 11\n  ..$ mpg : num 30.4\n  ..$ cyl : num 4\n  ..$ disp: num 95.1\n  ..$ hp  : num 113\n  ..$ drat: num 3.77\n  ..$ wt  : num 1.51\n  ..$ qsec: num 16.9\n  ..$ vs  : num 1\n  ..$ am  : num 1\n  ..$ gear: num 5\n  ..$ carb: num 2\n $ :List of 11\n  ..$ mpg : num 15.8\n  ..$ cyl : num 8\n  ..$ disp: num 351\n  ..$ hp  : num 264\n  ..$ drat: num 4.22\n  ..$ wt  : num 3.17\n  ..$ qsec: num 14.5\n  ..$ vs  : num 0\n  ..$ am  : num 1\n  ..$ gear: num 5\n  ..$ carb: num 4\n $ :List of 11\n  ..$ mpg : num 19.7\n  ..$ cyl : num 6\n  ..$ disp: num 145\n  ..$ hp  : num 175\n  ..$ drat: num 3.62\n  ..$ wt  : num 2.77\n  ..$ qsec: num 15.5\n  ..$ vs  : num 0\n  ..$ am  : num 1\n  ..$ gear: num 5\n  ..$ carb: num 6\n $ :List of 11\n  ..$ mpg : num 15\n  ..$ cyl : num 8\n  ..$ disp: num 301\n  ..$ hp  : num 335\n  ..$ drat: num 3.54\n  ..$ wt  : num 3.57\n  ..$ qsec: num 14.6\n  ..$ vs  : num 0\n  ..$ am  : num 1\n  ..$ gear: num 5\n  ..$ carb: num 8\n $ :List of 11\n  ..$ mpg : num 21.4\n  ..$ cyl : num 4\n  ..$ disp: num 121\n  ..$ hp  : num 109\n  ..$ drat: num 4.11\n  ..$ wt  : num 2.78\n  ..$ qsec: num 18.6\n  ..$ vs  : num 1\n  ..$ am  : num 1\n  ..$ gear: num 4\n  ..$ carb: num 2"
  },
  {
    "objectID": "datatypes.html",
    "href": "datatypes.html",
    "title": "3  Data Types",
    "section": "",
    "text": "R has no scalars, only vectors. A scalar is a vector of length 1\n\n\n\n\n\n\n\n\nLists are different from atomic vectors as they their elements can be of any type, even other lists\nWhile vectors are created with c(), lists can be created with list()\nc() will combine multiple lists into one\n\n\nl1 = list(a = 1, b=c(1,2,3))\nl2 = list(c=3, d=c(4,5,6))\nlCombined = c(l1,l2)"
  },
  {
    "objectID": "datatypes.html#d-1",
    "href": "datatypes.html#d-1",
    "title": "2  Data Types",
    "section": "2.2 2D",
    "text": "2.2 2D\n\n2.2.1 Homogenoues\n\n2.2.1.1 Matrices\n\n2.2.1.1.0.1 Create a matrix\n\nThe matrix is filled first down the columns\nTo create a matrix you can give it the numbers and then provide the dimensions\n\n\n\n     [,1] [,2] [,3]\n[1,]    1    5    9\n[2,]    2    6   10\n[3,]    3    7   11\n[4,]    4    8   12\n\n\n     [,1] [,2]\n[1,]    5    9\n[2,]    6   10\n\n\n[1] 5 6 7 8\n\n\n     [,1]\n[1,]    5\n[2,]    6\n[3,]    7\n[4,]    8\n\n\n\n\n\n\n2.2.2 Heterogenous\n\n2.2.2.1 Data frames\n\nData frames are lists"
  },
  {
    "objectID": "datatypes.html#nd",
    "href": "datatypes.html#nd",
    "title": "2  Data Types",
    "section": "2.3 nd",
    "text": "2.3 nd\n\n2.3.1 Homogenoues\n\n2.3.1.1 Arrays"
  },
  {
    "objectID": "sf.html#data",
    "href": "sf.html#data",
    "title": "7  SF",
    "section": "7.1 Data",
    "text": "7.1 Data\n\n\nCode\nelev = rast(system.file(\"raster/elev.tif\", package = \"spData\"))\ngrain = rast(system.file(\"raster/grain.tif\", package = \"spData\"))\n\n\n\n7.1.1 Vector data Opperations\n\n7.1.1.1 Spatial Subsetting\n\nTaking a spatial object and returning only features that relate in space to another object\nAs in attribute subsettung the square bracket syntax can be used\nx[y,,op=st_intersect] where x is an sf object of which these rows will be returned that intersect with y\nop=st_intersects is the topological relation. st_intersects() is the default topological relation. So x[y,] is the same as the above\n\n\n\nCode\ncanterbury = nz |&gt; filter(Name == \"Canterbury\")\ncanterbury_height = nz_height[canterbury, ]\n\n\np_hpnz1 = tm_shape(nz) + tm_polygons(col = \"white\") +\n  tm_shape(nz_height) + tm_symbols(shape = 2, col = \"red\", size = 0.25) +\n  tm_layout(main.title = \"High points in New Zealand\", main.title.size = 1,\n            bg.color = \"lightblue\")\n\n\nWarning: The 'main.title' argument of tm_layout is deprecated as of tmap 4.0.\nPlease use tm_title instead.\n\n\nCode\np_hpnz2 = tm_shape(nz) + tm_polygons(col = \"white\") +\n  tm_shape(canterbury) + tm_fill(col = \"gray\") + \n  tm_shape(canterbury_height) + tm_symbols(shape = 2, col = \"red\", size = 0.25) +\n  tm_layout(main.title = \"High points in Canterbury\", main.title.size = 1,\n            bg.color = \"lightblue\")\n\n\nWarning: The 'main.title' argument of tm_layout is deprecated as of tmap 4.0.\nPlease use tm_title instead.\n\n\nCode\ntmap_arrange(p_hpnz1, p_hpnz2, ncol = 2)"
  },
  {
    "objectID": "sf.html#conversion-between-spatial-formats",
    "href": "sf.html#conversion-between-spatial-formats",
    "title": "7  SF",
    "section": "7.2 Conversion between spatial formats",
    "text": "7.2 Conversion between spatial formats"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Make my life easy with R",
    "section": "",
    "text": "1 This is the index page"
  },
  {
    "objectID": "ggplot.html#types",
    "href": "ggplot.html#types",
    "title": "4  Ggplot",
    "section": "4.1 Types",
    "text": "4.1 Types\n\n4.1.1 Stacked Bar Chart\nThe data first:\n\n\nCode\nshare = rep(0.1, 10)\nvals = letters[1:10]\ndata = data.frame(\n share, vals \n)\n\n\nThe plot\n\n\nCode\nggplot(data) +\n  geom_col(aes(x = share,\n               y = \"a\", # if you were to use a numeric like one you need to set the orientation to \"y\"\n               fill = vals),\n           # orientation = \"y\",\n           position = position_stack())\n\n\n\n\n\n\n\nCode\ndf = data.frame(\n  x = 1:10,\n  y = 2:11\n)\n\n\n\n\nCode\n{\n // somehow get access to the df\n}"
  },
  {
    "objectID": "ggplot.html#internals",
    "href": "ggplot.html#internals",
    "title": "4  Ggplot",
    "section": "4.2 Internals",
    "text": "4.2 Internals\nThe data\n\n\n   names count share label   color\nv1    v1    55  0.76  76 % #df91a3\nv2    v2    13  0.18  18 % #A5AA99\nv3    v3     2  0.03  &lt;NA&gt; #A5AA99\nv4    v4     2  0.03  &lt;NA&gt; #A5AA99\n\n\n\n4.2.1 Inspecting a Horizontal Stacked Bar Chart\n\n\nCode\npl_works = ggplot(df) +\n  geom_col(\n    aes(x = share,\n        y = \"a\",\n        group = names),\n    color = \"black\",\n    fill = df$color,\n    position = ggplot2::position_fill()\n  ) \n\n\npl_not_works = ggplot(df) +\n  geom_col(\n    aes(x = share,\n        y = 1,\n        group = names),\n    color = \"black\",\n    fill = df$color,\n    position = ggplot2::position_fill()\n  ) \n\n\n\n4.2.1.0.1 The Computed Data\n\nThe ggplot function ggplot2::layer_data( &lt;plot-object&gt; ) gives you back the data that is used to draw the objects\nSimilarly the ggplot2::ggplot_build( &lt;plot-object&gt; ) gives you back a list with the elements data (again), layout and the actual plot already!\nAs the ggplot_build()-function is a method (like print is), it could (in theory be used for other objects too). So you can inspect it with\n\n\n\nCode\nggplot2:::ggplot_build.ggplot\n\n\nfunction (plot) \n{\n    plot &lt;- plot_clone(plot)\n    if (length(plot$layers) == 0) {\n        plot &lt;- plot + geom_blank()\n    }\n    layers &lt;- plot$layers\n    data &lt;- rep(list(NULL), length(layers))\n    scales &lt;- plot$scales\n    data &lt;- by_layer(function(l, d) l$layer_data(plot$data), \n        layers, data, \"computing layer data\")\n    data &lt;- by_layer(function(l, d) l$setup_layer(d, plot), layers, \n        data, \"setting up layer\")\n    layout &lt;- create_layout(plot$facet, plot$coordinates)\n    data &lt;- layout$setup(data, plot$data, plot$plot_env)\n    data &lt;- by_layer(function(l, d) l$compute_aesthetics(d, plot), \n        layers, data, \"computing aesthetics\")\n    data &lt;- lapply(data, scales_transform_df, scales = scales)\n    scale_x &lt;- function() scales$get_scales(\"x\")\n    scale_y &lt;- function() scales$get_scales(\"y\")\n    layout$train_position(data, scale_x(), scale_y())\n    data &lt;- layout$map_position(data)\n    data &lt;- by_layer(function(l, d) l$compute_statistic(d, layout), \n        layers, data, \"computing stat\")\n    data &lt;- by_layer(function(l, d) l$map_statistic(d, plot), \n        layers, data, \"mapping stat to aesthetics\")\n    scales_add_missing(plot, c(\"x\", \"y\"), plot$plot_env)\n    data &lt;- by_layer(function(l, d) l$compute_geom_1(d), layers, \n        data, \"setting up geom\")\n    data &lt;- by_layer(function(l, d) l$compute_position(d, layout), \n        layers, data, \"computing position\")\n    layout$reset_scales()\n    layout$train_position(data, scale_x(), scale_y())\n    layout$setup_panel_params()\n    data &lt;- layout$map_position(data)\n    npscales &lt;- scales$non_position_scales()\n    if (npscales$n() &gt; 0) {\n        lapply(data, scales_train_df, scales = npscales)\n        data &lt;- lapply(data, scales_map_df, scales = npscales)\n    }\n    data &lt;- by_layer(function(l, d) l$compute_geom_2(d), layers, \n        data, \"setting up geom aesthetics\")\n    data &lt;- by_layer(function(l, d) l$finish_statistics(d), layers, \n        data, \"finishing layer stat\")\n    data &lt;- layout$finish_data(data)\n    plot$labels$alt &lt;- get_alt_text(plot)\n    structure(list(data = data, layout = layout, plot = plot), \n        class = \"ggplot_built\")\n}\n&lt;bytecode: 0x56498a17c718&gt;\n&lt;environment: namespace:ggplot2&gt;\n\n\n\n\nCode\nld_works = layer_data(pl_works) %&gt;% mutate(works = \"y\") %&gt;% as_tibble()\nld_not_works = layer_data(pl_not_works) %&gt;% mutate(works = \"n\") %&gt;% as_tibble()\n\n\n\n\nCode\ncurve_df = data.frame(\n  x = .2,\n  y = 1,\n  xend = .7,\n  yend = 1.2\n)\n\npl_with_arrow = pl_works +\n  geom_curve(data = curve_df,\n             aes(\n               x = x,\n               y = y,\n               xend = xend,\n               yend = yend\n             ))"
  },
  {
    "objectID": "ggplot.html#examples",
    "href": "ggplot.html#examples",
    "title": "4  Ggplot",
    "section": "4.3 Examples",
    "text": "4.3 Examples\n\n4.3.1 1: Stacked Horizontal Chicklets\n\nFrom here\n\n\n\nCode\n# load libraries\n# devtools::install_github(\"tidyverse/ggplot2\")\nlibrary(ggplot2)\nlibrary(ggchicklet)\nlibrary(ggtext)\nlibrary(dplyr)\nlibrary(forcats)\nlibrary(grid)\n\n# import data\ndat &lt;- dat &lt;- data.frame(\n  Sport = c(\"NFL\", \"NFL\", \"NFL\", \"MLB\", \"MLB\", \"MLB\", \"NBA\", \"NBA\",\n            \"NBA\", \"NHL\", \"NHL\", \"NHL\", \"EPL\", \"EPL\", \"EPL\"),\n  Type = c(\"Game Action\", \"Nonaction\", \"Commercials\", \"Game Action\", \n            \"Nonaction\", \"Commercials\", \"Game Action\", \"Nonaction\", \"Commercials\", \n            \"Game Action\", \"Nonaction\", \"Commercials\", \"Game Action\", \"Nonaction\", \n            \"Commercials\"),\n  Time = c(18, 140.6, 49.9, 22.5, 150.9, 51.8, 49.6, 61.8,\n           33.5, 63, 56.6, 37.4, 58.7, 47.8, 10.1),\n  stringsAsFactors = FALSE)\n\n# refactor levels\ndat &lt;- dat %&gt;% group_by(Sport) %&gt;% mutate(Percent = Time/sum(Time)) %&gt;% ungroup() %&gt;% \n  mutate(Sport = fct_relevel(\n    Sport,\n    rev(c(\"NFL\", \"MLB\", \"NBA\", \"NHL\", \"EPL\")))\n  ) %&gt;% \n  mutate(Type = fct_relevel(\n    Type,\n    c(\"Commercials\",\"Nonaction\",\"Game Action\"))\n  ) \n\n# keep trailing zeroes and add \"min\" to first bar value labels\ndat$Label &lt;- as.character(sprintf(\"%.1f\", dat$Time))\ndat$Label &lt;- ifelse(dat$Type == \"Game Action\", paste0(dat$Label, \" min\"), dat$Label)\n\n# generate plot\ngg &lt;- ggplot(dat, aes(Sport, Percent,  fill = Type, label = Label)) +\n  geom_chicklet(\n    width = 1,\n    radius = unit(6, units = \"pt\"),\n    position = ggplot2::position_stack(reverse = FALSE)\n  ) +\n  geom_text(size = 4,\n            fontface = \"bold\",\n            position = position_stack(vjust = 0.5)) +\n  scale_y_continuous(limits = c(0, 1), expand = c(0, 0)) +  \n  coord_flip() +\n  theme_minimal() +\n  theme(\n    legend.position = \"top\",\n    plot.title = element_markdown(hjust = 0.5, family = \"Raleway\"),\n    plot.subtitle = element_markdown(hjust = 0.5),\n    plot.caption = element_markdown(\n      hjust = 0,\n      size = 11,\n      margin = unit(c(0, 0, 0, 0), \"cm\"),\n      color = \"#718c9e\"\n    ),\n    legend.text = element_markdown(size = 11),\n    axis.text = element_text(face = \"bold\", size = 11),\n    axis.text.x = element_blank(),\n    axis.title.y = element_markdown(\n      hjust = 0,\n      size = 20,\n      margin = unit(c(0, 0, 0, 0), \"cm\"),\n      color = \"#718c9e\"\n    ),\n    panel.grid = element_blank(),\n    axis.title.x = element_markdown(\n      halign = 0,\n      margin = margin(2, 0, 15, 0),\n      fill = \"transparent\"\n    )\n    \n  ) +\n  scale_fill_manual(\n    name = NULL,\n    values = c(\n      `Game Action` = \"#FA759F\",\n      Nonaction = \"#B5BEC9\",\n      Commercials = \"#72D4DB\"\n    ),\n    labels = c(\n      # `Game Action` = \"&lt;strong style='color:#FA759F'&gt;GAME ACTION&lt;/strong&gt; (BALL OR PUCK IN PLAY)\",\n      # Nonaction = \"&lt;strong style='color:#B5BEC9'&gt;NONACTION&lt;/strong&gt; (GAME STOPPAGE, COMMENTARY, ETC.)\",\n      # Commercials = \"&lt;strong style='color:#72D4DB'&gt;COMMERCIALS&lt;/strong&gt;\")\n      `Game Action` = \"&lt;strong&gt;GAME ACTION&lt;/strong&gt; (BALL OR PUCK IN PLAY)\",\n      Nonaction = \"&lt;strong&gt;NONACTION&lt;/strong&gt; (GAME STOPPAGE, COMMENTARY, ETC.)\",\n      Commercials = \"&lt;strong&gt;COMMERCIALS&lt;/strong&gt;\"\n    ),\n    guide = guide_legend(reverse = TRUE)\n  ) +\n  labs(\n    y = \"&lt;span style='font-size:13pt;'&gt;The average share of broadcast time showing &lt;strong style='color:#FA759F'&gt;GAME ACTION&lt;/strong&gt; is highest in&lt;br&gt;the English Premier League - but there is more total action in an average&lt;br&gt;National Hockey League game, which lasts longer.&lt;/span&gt;\",\n    x = NULL,\n    fill = NULL,\n    title = \"&lt;b&gt;NFL and MLB games are long, slow affairs&lt;/b&gt;\",\n    subtitle = \"Minutes by broadcast by what is shown on screen across five major men's sports leagues\",\n    caption = \"Games that we included: 10 NFL regular-season games between Nov. 7 amd Nov. 18, 2019. 17 MLB postseason games, including all the games in the 2019\n    ACLS, NLCS, and World&lt;br&gt;Series; 10 NBA regular-season games between Nov. 6 and Nov. 15, 2019; 10 NHL regular-season games between Nov. 5 and Nov. 19, 2019, including three overtime games;\n    and&lt;br&gt;seven English Premier League games between Nov. 9 and Nov. 23, 2019. NBA game action includes free throws, so the action time exceeds the game time.&lt;br&gt;\n    &lt;br&gt;\n    FivethirtyEight SOURCE: UNIVERSITY OF TEXAS AT AUSTIN SPORTS ANALYTICS COURSE\"\n  )\n\ngg\n\nalignTitles &lt;- function(ggplot, title = NULL, subtitle = NULL, caption = NULL) {\n  # grab the saved ggplot2 object\n  g &lt;- ggplotGrob(ggplot)\n  \n  \n  # find the object which provides the plot information for the title, subtitle, and caption\n  if(!is.null(title)) {\n    g$layout[which(g$layout$name == \"title\"),]$l &lt;- title\n  }\n  if(!is.null(subtitle)) {\n    g$layout[which(g$layout$name == \"subtitle\"),]$l &lt;- subtitle\n  }\n  if(!is.null(caption)) {\n    g$layout[which(g$layout$name == \"caption\"),]$l &lt;- caption\n  }\n  g\n}\n\n# align caption to y axis value labels\ngg2 &lt;- alignTitles(gg, caption = 2)\ngrid.draw(gg2)\n\n# add arrow\nx &lt;- rev(c(0.25, 0.25, 0.28, 0.28))\ny &lt;- rev(c(0.2, 0.15, 0.15, 0.15))\ngrid.bezier(x, y, gp=gpar(lwd=1.5, fill=\"black\"),\n            arrow=arrow(type=\"open\",length = unit(0.1, \"inches\")))"
  },
  {
    "objectID": "intro.html#attach-a-datframe",
    "href": "intro.html#attach-a-datframe",
    "title": "2  Intro",
    "section": "2.1 attach a datframe",
    "text": "2.1 attach a datframe\n\nThis creates a new environment\n\n\n\nCode\nsuppressMessages(attach(mtcars)) \nplot(mpg, cyl)\n\n\n\n\n\nCode\nsearch() # list search paths for r objects -&gt; the mtcars object is now a search path\n\n\n [1] \".GlobalEnv\"        \"mtcars\"            \"package:stats\"    \n [4] \"package:graphics\"  \"package:grDevices\" \"package:utils\"    \n [7] \"package:datasets\"  \"package:methods\"   \"Autoloads\"        \n[10] \"package:base\"     \n\n\nCode\n# http://adv-r.had.co.nz/Environments.html\nls(envir=as.environment(mtcars))\n\n\n [1] \"am\"   \"carb\" \"cyl\"  \"disp\" \"drat\" \"gear\" \"hp\"   \"mpg\"  \"qsec\" \"vs\"  \n[11] \"wt\""
  },
  {
    "objectID": "datatypes.html#d",
    "href": "datatypes.html#d",
    "title": "2  Data Types",
    "section": "2.1 1D",
    "text": "2.1 1D\n\n2.1.1 Homogenoues\n\n2.1.1.1 Vectors\n\nR has no scalars, only vectors. A scalar is a vector of length 1\n\n\n\n\n2.1.2 Heterogenous\n\n2.1.2.1 Lists\n\nLists are different from atomic vectors as they their elements can be of any type, even other lists\nWhile vectors are created with c(), lists can be created with list()\nc() will combine multiple lists into one\n\n\n\nCode\nl1 = list(a = 1, b=c(1,2,3))\nl2 = list(c=3, d=c(4,5,6))\nlCombined = c(l1,l2)"
  },
  {
    "objectID": "sf.html#vector-data-opperations",
    "href": "sf.html#vector-data-opperations",
    "title": "5  SF",
    "section": "5.2 Vector data Opperations",
    "text": "5.2 Vector data Opperations\n\n5.2.1 Spatial Subsetting\n\nTaking a spatial object and returning only features that relate in space to another object\nAs in attribute subsetting the square bracket syntax can be used\nx[y,,op=st_intersect] where x is an sf object of which these rows will be returned that intersect with y\nop=st_intersects is the topological relation. st_intersects() is the default topological relation. So x[y,] is the same as the above\n\n\n\nCode\ncanterbury = nz |&gt; filter(Name == \"Canterbury\")\ncanterbury_height = nz_height[canterbury, ]\n\n\np_hpnz1 = tm_shape(nz) + tm_polygons(col = \"white\") +\n  tm_shape(nz_height) + tm_symbols(shape = 2, col = \"red\", size = 0.25) +\n  tm_layout(main.title = \"High points in New Zealand\", main.title.size = 1,\n            bg.color = \"lightblue\")\np_hpnz2 = tm_shape(nz) + tm_polygons(col = \"white\") +\n  tm_shape(canterbury) + tm_fill(col = \"gray\") + \n  tm_shape(canterbury_height) + tm_symbols(shape = 2, col = \"red\", size = 0.25) +\n  tm_layout(main.title = \"High points in Canterbury\", main.title.size = 1,\n            bg.color = \"lightblue\")\ntmap_arrange(p_hpnz1, p_hpnz2, ncol = 2)\n\n\n\n\n\n\n\n5.2.2 Clipping, intersecting,…\n\nLets imagine we have a two polygons\nThe very big, non-simppified 2115 gemeinden of Austria, and a 50km Grid overlaid\nNow we can ask many qustions!\n\n\n\nCode\npath_gemeinden_2023 = here(\"data/geodata/gems_oe_31287.fgb\")\ngems = read_sf(path_gemeinden_2023)\ngrid = st_make_grid(gems, cellsize = 50000) %&gt;% st_sf()\noe = read_sf(here(\"data/geodata/oe_outline_31287.fgb\"))\nplot(grid)\nplot(gems[0], add=T, border=\"red\")\n\n\n\n\n\n\nHow many districts intersect with each grid cell?\n\n\n\nCode\nstIntersects = function(a, b){\n  is =st_intersects(a,b) \n  ls = lengths(is)\n  a[[\"n_intersections\"]] = ls\n  return(a)\n}\n\n\nstIntersectsDplyr = function(a, b){\n  a = a %&gt;% \n    mutate(\n      n_intersections = lengths(st_intersects(., b))\n    )\n  return(a)\n}\n\nb = bench::mark(\n  noDplyr = stIntersects(grid, gems),\n  dplyr = stIntersectsDplyr(grid, gems)\n)\n\nres = stIntersects(grid, gems)\nggplot() +\n  geom_sf(data =res, aes(fill=n_intersections), show.legend = F) +\n  geom_sf(data =oe, fill=NA, color=\"pink\", linewidth=1) +\n  geom_sf_text(data=res, aes(label=n_intersections), color=\"white\") +\n  labs(\n    x =NULL,\n    y =NULL\n  ) + theme_void()\n\n\n\n\n\n\nGEOS\n\n\nDoing the same in geos\n\nOh and its so much faster…\n\n\nCode\ngeosIntersect = function(a, b){\n  a_geos = as_geos_geometry(a)\n  b_stre = as_geos_strtree(b)\n  n_intersections = lengths(geos_intersects_matrix(a_geos, b_stre))\n  a[[\"n_intersections\"]]   = n_intersections\n  return(a)\n}\n\ncompare_sf_geos = bench::mark(\n  check = T,\n  sf = stIntersects(grid, gems),\n  geos = geosIntersect(grid, gems)\n)\n\ncompare_sf_geos\n\n\n# A tibble: 2 × 6\n  expression      min   median `itr/sec` mem_alloc `gc/sec`\n  &lt;bch:expr&gt; &lt;bch:tm&gt; &lt;bch:tm&gt;     &lt;dbl&gt; &lt;bch:byt&gt;    &lt;dbl&gt;\n1 sf          414.9ms  434.9ms      2.30     117MB     2.30\n2 geos         69.6ms   88.5ms     11.9      248KB     0   \n\n\n\nHow big is the share of each gemeinde that it lies within each grid cell\n\n\n\nCode\nareaNoDplyr = function(a){\n  a[[\"area\"]] = st_area(a)\n  return(a)\n}\n\nareaDplyr = function(a){\n  a = a %&gt;% \n    mutate(\n      area = st_area(.)\n    )\n  return(a)\n}\n\nb_area = bench::mark(\n  dplyr = areaDplyr(gems),\n  no_dplyr = areaNoDplyr(gems)\n)\n\nareaIntersection = function(a, b){\n  # get area for b\n  b = b %&gt;% \n    mutate(\n      area = st_area(.)\n    )\n  \n  share = b %&gt;% \n    st_intersection(grid) %&gt;% \n    mutate(\n      share = units::drop_units(st_area(.) / area)\n    )\n  return(share)\n}\n\n\nareas_share = areaIntersection(grid, gems)\n\n\nggplot() +\n  geom_sf(data = areas_share,\n          aes(fill = share))  +\n  theme_void()\n\n\n\n\n\n\n\n5.2.3 Unions"
  },
  {
    "objectID": "dplyr.html#rowwise-compute-value-for-new-column-with-subset-of-existing-columns",
    "href": "dplyr.html#rowwise-compute-value-for-new-column-with-subset-of-existing-columns",
    "title": "3  Dplyr",
    "section": "4.1 Rowwise Compute value for new column with subset of existing columns",
    "text": "4.1 Rowwise Compute value for new column with subset of existing columns\n\n\nCode\n# pmap loops over multiple lists|vectors at the same time\n# in this case all the numeric columns in mtcars\n# the ~median(c(...)) says take all the cols\nmtcars %&gt;% \n  mutate(\n    med = pmap_dbl(select(., where(is.numeric)), ~median(c(...), na.rm = T))\n  )  %&gt;% glimpse\n\n\nRows: 32\nColumns: 13\n$ mpg    &lt;dbl&gt; 21.0, 21.0, 22.8, 21.4, 18.7, 18.1, 14.3, 24.4, 22.8, 19.2, 17.…\n$ cyl    &lt;dbl&gt; 6, 6, 4, 6, 8, 6, 8, 4, 4, 6, 6, 8, 8, 8, 8, 8, 8, 4, 4, 4, 4, …\n$ disp   &lt;dbl&gt; 160.0, 160.0, 108.0, 258.0, 360.0, 225.0, 360.0, 146.7, 140.8, …\n$ hp     &lt;dbl&gt; 110, 110, 93, 110, 175, 105, 245, 62, 95, 123, 123, 180, 180, 1…\n$ drat   &lt;dbl&gt; 3.90, 3.90, 3.85, 3.08, 3.15, 2.76, 3.21, 3.69, 3.92, 3.92, 3.9…\n$ wt     &lt;dbl&gt; 2.620, 2.875, 2.320, 3.215, 3.440, 3.460, 3.570, 3.190, 3.150, …\n$ qsec   &lt;dbl&gt; 16.46, 17.02, 18.61, 19.44, 17.02, 20.22, 15.84, 20.00, 22.90, …\n$ vs     &lt;dbl&gt; 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, …\n$ am     &lt;dbl&gt; 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, …\n$ gear   &lt;dbl&gt; 4, 4, 4, 3, 3, 3, 3, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 4, 4, 4, 3, …\n$ carb   &lt;dbl&gt; 4, 4, 1, 1, 2, 1, 4, 2, 2, 4, 4, 3, 3, 3, 4, 4, 4, 1, 2, 1, 1, …\n$ string &lt;chr&gt; \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\"…\n$ med    &lt;dbl&gt; 4.000, 4.000, 4.000, 3.215, 3.440, 3.460, 4.000, 4.000, 4.000, …\n\n\n\n4.1.1 do the same as above, but only use two cols and get their mean\n\n\nCode\nmtcars %&gt;% \n  mutate(\n    med = pmap_dbl(select(., matches(\"disp|hp\")), ~median(c(...), na.rm = T))\n  )  %&gt;% glimpse\n\n\nRows: 32\nColumns: 13\n$ mpg    &lt;dbl&gt; 21.0, 21.0, 22.8, 21.4, 18.7, 18.1, 14.3, 24.4, 22.8, 19.2, 17.…\n$ cyl    &lt;dbl&gt; 6, 6, 4, 6, 8, 6, 8, 4, 4, 6, 6, 8, 8, 8, 8, 8, 8, 4, 4, 4, 4, …\n$ disp   &lt;dbl&gt; 160.0, 160.0, 108.0, 258.0, 360.0, 225.0, 360.0, 146.7, 140.8, …\n$ hp     &lt;dbl&gt; 110, 110, 93, 110, 175, 105, 245, 62, 95, 123, 123, 180, 180, 1…\n$ drat   &lt;dbl&gt; 3.90, 3.90, 3.85, 3.08, 3.15, 2.76, 3.21, 3.69, 3.92, 3.92, 3.9…\n$ wt     &lt;dbl&gt; 2.620, 2.875, 2.320, 3.215, 3.440, 3.460, 3.570, 3.190, 3.150, …\n$ qsec   &lt;dbl&gt; 16.46, 17.02, 18.61, 19.44, 17.02, 20.22, 15.84, 20.00, 22.90, …\n$ vs     &lt;dbl&gt; 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, …\n$ am     &lt;dbl&gt; 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, …\n$ gear   &lt;dbl&gt; 4, 4, 4, 3, 3, 3, 3, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 4, 4, 4, 3, …\n$ carb   &lt;dbl&gt; 4, 4, 1, 1, 2, 1, 4, 2, 2, 4, 4, 3, 3, 3, 4, 4, 4, 1, 2, 1, 1, …\n$ string &lt;chr&gt; \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\"…\n$ med    &lt;dbl&gt; 135.00, 135.00, 100.50, 184.00, 267.50, 165.00, 302.50, 104.35,…\n\n\nor simpler if you know the columns\n\n\nCode\nmtcars %&gt;% \n  rowwise() %&gt;%\n  mutate(\n    med = median(disp, hp)\n  ) %&gt;% glimpse\n\n\nRows: 32\nColumns: 13\nRowwise: \n$ mpg    &lt;dbl&gt; 21.0, 21.0, 22.8, 21.4, 18.7, 18.1, 14.3, 24.4, 22.8, 19.2, 17.…\n$ cyl    &lt;dbl&gt; 6, 6, 4, 6, 8, 6, 8, 4, 4, 6, 6, 8, 8, 8, 8, 8, 8, 4, 4, 4, 4, …\n$ disp   &lt;dbl&gt; 160.0, 160.0, 108.0, 258.0, 360.0, 225.0, 360.0, 146.7, 140.8, …\n$ hp     &lt;dbl&gt; 110, 110, 93, 110, 175, 105, 245, 62, 95, 123, 123, 180, 180, 1…\n$ drat   &lt;dbl&gt; 3.90, 3.90, 3.85, 3.08, 3.15, 2.76, 3.21, 3.69, 3.92, 3.92, 3.9…\n$ wt     &lt;dbl&gt; 2.620, 2.875, 2.320, 3.215, 3.440, 3.460, 3.570, 3.190, 3.150, …\n$ qsec   &lt;dbl&gt; 16.46, 17.02, 18.61, 19.44, 17.02, 20.22, 15.84, 20.00, 22.90, …\n$ vs     &lt;dbl&gt; 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, …\n$ am     &lt;dbl&gt; 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, …\n$ gear   &lt;dbl&gt; 4, 4, 4, 3, 3, 3, 3, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 4, 4, 4, 3, …\n$ carb   &lt;dbl&gt; 4, 4, 1, 1, 2, 1, 4, 2, 2, 4, 4, 3, 3, 3, 4, 4, 4, 1, 2, 1, 1, …\n$ string &lt;chr&gt; \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\"…\n$ med    &lt;dbl&gt; 160.0, 160.0, 108.0, 258.0, 360.0, 225.0, 360.0, 146.7, 140.8, …"
  },
  {
    "objectID": "dplyr.html#adding-new-columns",
    "href": "dplyr.html#adding-new-columns",
    "title": "3  Dplyr",
    "section": "3.5 Adding new Columns",
    "text": "3.5 Adding new Columns\n\n3.5.1 Rowwise Compute value for new column with subset of existing columns\n\n\nCode\n# pmap loops over multiple lists|vectors at the same time\n# in this case all the numeric columns in mtcars\n# the ~median(c(...)) says take all the cols\nmtcars %&gt;% \n  mutate(\n    med = pmap_dbl(select(., where(is.numeric)), ~median(c(...), na.rm = T))\n  )  %&gt;% glimpse\n\n\nRows: 32\nColumns: 13\n$ mpg    &lt;dbl&gt; 21.0, 21.0, 22.8, 21.4, 18.7, 18.1, 14.3, 24.4, 22.8, 19.2, 17.…\n$ cyl    &lt;dbl&gt; 6, 6, 4, 6, 8, 6, 8, 4, 4, 6, 6, 8, 8, 8, 8, 8, 8, 4, 4, 4, 4, …\n$ disp   &lt;dbl&gt; 160.0, 160.0, 108.0, 258.0, 360.0, 225.0, 360.0, 146.7, 140.8, …\n$ hp     &lt;dbl&gt; 110, 110, 93, 110, 175, 105, 245, 62, 95, 123, 123, 180, 180, 1…\n$ drat   &lt;dbl&gt; 3.90, 3.90, 3.85, 3.08, 3.15, 2.76, 3.21, 3.69, 3.92, 3.92, 3.9…\n$ wt     &lt;dbl&gt; 2.620, 2.875, 2.320, 3.215, 3.440, 3.460, 3.570, 3.190, 3.150, …\n$ qsec   &lt;dbl&gt; 16.46, 17.02, 18.61, 19.44, 17.02, 20.22, 15.84, 20.00, 22.90, …\n$ vs     &lt;dbl&gt; 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, …\n$ am     &lt;dbl&gt; 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, …\n$ gear   &lt;dbl&gt; 4, 4, 4, 3, 3, 3, 3, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 4, 4, 4, 3, …\n$ carb   &lt;dbl&gt; 4, 4, 1, 1, 2, 1, 4, 2, 2, 4, 4, 3, 3, 3, 4, 4, 4, 1, 2, 1, 1, …\n$ string &lt;chr&gt; \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\"…\n$ med    &lt;dbl&gt; 4.000, 4.000, 4.000, 3.215, 3.440, 3.460, 4.000, 4.000, 4.000, …\n\n\ndo the same as above, but only use two cols and get their mean\n\n\nCode\nmtcars %&gt;% \n  mutate(\n    med = pmap_dbl(select(., matches(\"disp|hp\")), ~median(c(...), na.rm = T))\n  )  %&gt;% glimpse\n\n\nRows: 32\nColumns: 13\n$ mpg    &lt;dbl&gt; 21.0, 21.0, 22.8, 21.4, 18.7, 18.1, 14.3, 24.4, 22.8, 19.2, 17.…\n$ cyl    &lt;dbl&gt; 6, 6, 4, 6, 8, 6, 8, 4, 4, 6, 6, 8, 8, 8, 8, 8, 8, 4, 4, 4, 4, …\n$ disp   &lt;dbl&gt; 160.0, 160.0, 108.0, 258.0, 360.0, 225.0, 360.0, 146.7, 140.8, …\n$ hp     &lt;dbl&gt; 110, 110, 93, 110, 175, 105, 245, 62, 95, 123, 123, 180, 180, 1…\n$ drat   &lt;dbl&gt; 3.90, 3.90, 3.85, 3.08, 3.15, 2.76, 3.21, 3.69, 3.92, 3.92, 3.9…\n$ wt     &lt;dbl&gt; 2.620, 2.875, 2.320, 3.215, 3.440, 3.460, 3.570, 3.190, 3.150, …\n$ qsec   &lt;dbl&gt; 16.46, 17.02, 18.61, 19.44, 17.02, 20.22, 15.84, 20.00, 22.90, …\n$ vs     &lt;dbl&gt; 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, …\n$ am     &lt;dbl&gt; 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, …\n$ gear   &lt;dbl&gt; 4, 4, 4, 3, 3, 3, 3, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 4, 4, 4, 3, …\n$ carb   &lt;dbl&gt; 4, 4, 1, 1, 2, 1, 4, 2, 2, 4, 4, 3, 3, 3, 4, 4, 4, 1, 2, 1, 1, …\n$ string &lt;chr&gt; \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\"…\n$ med    &lt;dbl&gt; 135.00, 135.00, 100.50, 184.00, 267.50, 165.00, 302.50, 104.35,…\n\n\nor simpler if you know the columns\n\n\nCode\nmtcars %&gt;% \n  rowwise() %&gt;%\n  mutate(\n    med = median(disp, hp)\n  ) %&gt;% glimpse\n\n\nRows: 32\nColumns: 13\nRowwise: \n$ mpg    &lt;dbl&gt; 21.0, 21.0, 22.8, 21.4, 18.7, 18.1, 14.3, 24.4, 22.8, 19.2, 17.…\n$ cyl    &lt;dbl&gt; 6, 6, 4, 6, 8, 6, 8, 4, 4, 6, 6, 8, 8, 8, 8, 8, 8, 4, 4, 4, 4, …\n$ disp   &lt;dbl&gt; 160.0, 160.0, 108.0, 258.0, 360.0, 225.0, 360.0, 146.7, 140.8, …\n$ hp     &lt;dbl&gt; 110, 110, 93, 110, 175, 105, 245, 62, 95, 123, 123, 180, 180, 1…\n$ drat   &lt;dbl&gt; 3.90, 3.90, 3.85, 3.08, 3.15, 2.76, 3.21, 3.69, 3.92, 3.92, 3.9…\n$ wt     &lt;dbl&gt; 2.620, 2.875, 2.320, 3.215, 3.440, 3.460, 3.570, 3.190, 3.150, …\n$ qsec   &lt;dbl&gt; 16.46, 17.02, 18.61, 19.44, 17.02, 20.22, 15.84, 20.00, 22.90, …\n$ vs     &lt;dbl&gt; 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, …\n$ am     &lt;dbl&gt; 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, …\n$ gear   &lt;dbl&gt; 4, 4, 4, 3, 3, 3, 3, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 4, 4, 4, 3, …\n$ carb   &lt;dbl&gt; 4, 4, 1, 1, 2, 1, 4, 2, 2, 4, 4, 3, 3, 3, 4, 4, 4, 1, 2, 1, 1, …\n$ string &lt;chr&gt; \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\", \"a\"…\n$ med    &lt;dbl&gt; 160.0, 160.0, 108.0, 258.0, 360.0, 225.0, 360.0, 146.7, 140.8, …"
  },
  {
    "objectID": "stars.html#stars-structure",
    "href": "stars.html#stars-structure",
    "title": "6  Stars",
    "section": "6.1 stars structure",
    "text": "6.1 stars structure\n\nnamed list of arrays, each having a dimension attribute\nan attribute called dimensions of class dimensions that holds the dimensions metadata\na class name that includes stars"
  },
  {
    "objectID": "stars.html#read-data",
    "href": "stars.html#read-data",
    "title": "6  Stars",
    "section": "6.2 read data",
    "text": "6.2 read data\n\nMonthly mean air temperature data from Geosphere\n\n\nhttps://dataset.api.hub.geosphere.at/app/frontend/raster/historical/spartacus-v2-1m-1km\n\n\n\nCode\n# spartacus temp data\nau_temp_jan_mar = read_ncdf(here(\"data/geodata/SPARTACUS - Spatial Dataset for Climate in Austria Datensatz_202301_202303.nc\")) %&gt;% st_set_crs(\"EPSG:3416\")\n\n# vienna for aggregation\nvienna = read_sf(here(\"data/geodata/gems_oe_31287.fgb\")) %&gt;% dplyr::filter(str_detect(g_id, \"^9.*\")) %&gt;% st_transform(3416)\nplot(au_temp_jan_mar)"
  },
  {
    "objectID": "stars.html#dimensions",
    "href": "stars.html#dimensions",
    "title": "6  Stars",
    "section": "6.6 Dimensions",
    "text": "6.6 Dimensions\n\nDimensions is a named list\n\n\n\nCode\ndimenstions_attr = attr(au_temp_jan_mar, \"dimensions\")\ndimenstions_attr\n\n\n     from  to offset delta                   refsys\nx       1 584 112000  1000 ETRS89 / Austria Lambert\ny       1 329 258000  1000 ETRS89 / Austria Lambert\ntime    1   3     NA    NA                  POSIXct\n                                             values x/y\nx                                              NULL [x]\ny                                              NULL [y]\ntime 2023-01-01 UTC, 2023-02-01 UTC, 2023-03-01 UTC"
  },
  {
    "objectID": "sf.html#sf",
    "href": "sf.html#sf",
    "title": "5  SF",
    "section": "5.1 SF",
    "text": "5.1 SF\n\nread here: https://r-spatial.org/book/07-Introsf.html\n\n\nWhat attributes does an sf-object have?\n\n\nname of the geometry column in an attribute called sf_column\nfor each non-geometry variable, the attribute-geometry relationship. What is that? read here: https://r-spatial.org/book/05-Attributes.html#exercises\n\n\n\nCode\nattributes(nz)\n\n\n$names\n[1] \"Name\"          \"Island\"        \"Land_area\"     \"Population\"   \n[5] \"Median_income\" \"Sex_ratio\"     \"geom\"         \n\n$row.names\n [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16\n\n$sf_column\n[1] \"geom\"\n\n$agr\n         Name        Island     Land_area    Population Median_income \n         &lt;NA&gt;          &lt;NA&gt;          &lt;NA&gt;          &lt;NA&gt;          &lt;NA&gt; \n    Sex_ratio \n         &lt;NA&gt; \nLevels: constant aggregate identity\n\n$class\n[1] \"sf\"         \"data.frame\"\n\n\n\nWhat attributes does a sfc-geometry list-column have?\n\n\n\nCode\nattributes(nz$geom)\n\n\n$class\n[1] \"sfc_MULTIPOLYGON\" \"sfc\"             \n\n$precision\n[1] 0\n\n$crs\nCoordinate Reference System:\n  User input: EPSG:2193 \n  wkt:\nPROJCS[\"NZGD2000 / New Zealand Transverse Mercator 2000\",\n    GEOGCS[\"NZGD2000\",\n        DATUM[\"New_Zealand_Geodetic_Datum_2000\",\n            SPHEROID[\"GRS 1980\",6378137,298.257222101,\n                AUTHORITY[\"EPSG\",\"7019\"]],\n            TOWGS84[0,0,0,0,0,0,0],\n            AUTHORITY[\"EPSG\",\"6167\"]],\n        PRIMEM[\"Greenwich\",0,\n            AUTHORITY[\"EPSG\",\"8901\"]],\n        UNIT[\"degree\",0.0174532925199433,\n            AUTHORITY[\"EPSG\",\"9122\"]],\n        AUTHORITY[\"EPSG\",\"4167\"]],\n    PROJECTION[\"Transverse_Mercator\"],\n    PARAMETER[\"latitude_of_origin\",0],\n    PARAMETER[\"central_meridian\",173],\n    PARAMETER[\"scale_factor\",0.9996],\n    PARAMETER[\"false_easting\",1600000],\n    PARAMETER[\"false_northing\",10000000],\n    UNIT[\"metre\",1,\n        AUTHORITY[\"EPSG\",\"9001\"]],\n    AUTHORITY[\"EPSG\",\"2193\"]]\n\n$n_empty\n[1] 0\n\n$bbox\n   xmin    ymin    xmax    ymax \n1090144 4748537 2089533 6191874"
  },
  {
    "objectID": "stars.html#find-mean-temperature-for-jan-feb-and-march-for-each-district-in-vienna",
    "href": "stars.html#find-mean-temperature-for-jan-feb-and-march-for-each-district-in-vienna",
    "title": "6  Stars",
    "section": "6.3 Find mean temperature for Jan, Feb and March for each District in Vienna",
    "text": "6.3 Find mean temperature for Jan, Feb and March for each District in Vienna\n\n\nCode\nper_district = aggregate(au_temp_jan_mar, vienna, FUN=mean)\nplot(per_district)"
  },
  {
    "objectID": "stars.html#in-which-month-was-the-max-temp-for-each-district",
    "href": "stars.html#in-which-month-was-the-max-temp-for-each-district",
    "title": "6  Stars",
    "section": "6.4 In which month was the max temp for each district",
    "text": "6.4 In which month was the max temp for each district\nUnsurprisingle it was in march…\n\n\nCode\nper_district_max = aggregate(au_temp_jan_mar, vienna, max)\n\nw = st_apply(per_district_max, \"geometry\", function(x){\n  return(ifelse(all(is.na(x)), NA, which.max(x)))\n})\nggplot() + geom_stars(data=w)"
  },
  {
    "objectID": "stars.html#for-each-value-in-the-timedimension-find-the-max-cell-with-geocoordinates",
    "href": "stars.html#for-each-value-in-the-timedimension-find-the-max-cell-with-geocoordinates",
    "title": "6  Stars",
    "section": "6.5 For each value in the timedimension find the max cell (with geocoordinates)",
    "text": "6.5 For each value in the timedimension find the max cell (with geocoordinates)\n\n\nCode\n# start with one\njan = au_temp_jan_mar[,,,1]\n# find the max cell and its centroid\nwhich.max(jan[[1]])\n\n\n[1] 131330"
  },
  {
    "objectID": "stars.html#attributes",
    "href": "stars.html#attributes",
    "title": "6  Stars",
    "section": "6.7 Attributes",
    "text": "6.7 Attributes"
  }
]